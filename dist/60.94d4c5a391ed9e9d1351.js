(function(){"use strict";var e=this,t=this,a=function(e,a,n){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var i=(n(327),n(326)),r=_interopRequireDefault(i),l=(n(628),n(627)),u=_interopRequireDefault(l),o=(n(49),n(48)),s=_interopRequireDefault(o),c=(n(51),n(50)),f=_interopRequireDefault(c),d=(n(1597),n(1596)),p=_interopRequireDefault(d),h=function(){function defineProperties(e,a){for(var n=0;n<a.length;n++){var i=a[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),t.Object.defineProperty(e,i.key,i)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),m=n(0),_=_interopRequireDefault(m),y=n(22),v=_interopRequireDefault(y),b=n(197),E=_interopRequireDefault(b),D=n(315),g=_interopRequireDefault(D),k=n(2336),S=_interopRequireDefault(k),P=function(e){function Index(e){_classCallCheck(this,Index);var a=_possibleConstructorReturn(this,(Index.__proto__||t.Object.getPrototypeOf(Index)).call(this,e));return a.state={isFetching:!1,authData:[]},["handleInsertAuthData","handleExpandChange","handleEditSuccess","handleDelete","handleCreateSuccess"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(Index,e),h(Index,[{key:"componentDidMount",value:function(){this.getAuthorityList(0)}},{key:"handleExpandChange",value:function(e,t){if(e){var a=t._id;this.getAuthorityList(a)}}},{key:"getAuthorityList",value:function(e){var t=this;this.setState({isFetching:!0}),v.default.ajax({url:v.default.authority.list(e)},function(e){t.setState({isFetching:!1}),t.handleInsertAuthData(e.res.list)},function(){t.setState({isFetching:!1})})}},{key:"handleDelete",value:function(e,t){var a=this;v.default.ajax({url:v.default.authority.delete(),type:"POST",data:{auth_item_id:t._id}},function(){a.handleDeleteSuccess(t)})}},{key:"handleDeleteSuccess",value:function(e,a){var n=this.state.authData,i=a||n;for(var r in i)if(i.hasOwnProperty(r)){if(t.String(i[r]._id)==t.String(e._id))return i.splice(r,1),this.setState({authData:i}),!0;i[r].children&&i[r].children.length>0&&this.handleDeleteSuccess(e,i[r].children)}this.setState({authData:i})}},{key:"handleEditSuccess",value:function(e,a){var n=this.state.authData,i=a||n;for(var r in i)if(i.hasOwnProperty(r)){if(t.String(i[r]._id)==t.String(e._id))return e.key=e._id,e.children=[],i[r]=e,this.setState({authData:i}),!0;i[r].children&&i[r].children.length>0&&this.handleEditSuccess(e,i[r].children)}this.setState({authData:i})}},{key:"handleCreateSuccess",value:function(e,a){var n=this.state.authData,i=a||n;for(var r in i)if(i.hasOwnProperty(r)){if(t.String(i[r]._id)==t.String(e.parent_id))return i[r].children||(i[r].children=[]),e.key=e._id,e.children=[],i[r].children.push(e),this.setState({authData:i}),!0;i[r].children&&i[r].children.length>0&&this.handleCreateSuccess(e,i[r].children)}this.setState({authData:i})}},{key:"handleInsertAuthData",value:function(e,a){if(0==e.length)return!1;var n=this.state.authData,i=a||n;if(0==i.length){for(var r in e)e.hasOwnProperty(r)&&(e[r].key=e[r]._id,e[r].children=[],i.push(e[r]));return this.setState({authData:i}),!0}for(var l in i)if(i.hasOwnProperty(l)){if(t.String(i[l]._id)==(e[0]&&e[0].parent_id||null)){i[l].children=[];for(var u in e)e.hasOwnProperty(u)&&(e[u].key=e[u]._id,e[u].children=[],i[l].children.push(e[u]));return this.setState({authData:i}),!0}i[l].children&&i[l].children.length>0&&this.handleInsertAuthData(e,i[l].children)}this.setState({authData:i})}},{key:"render",value:function(){var e=this.state.authData,t=this.state.isFetching,a=this,n=[{title:"功能名称",dataIndex:"name",key:"name"},{title:"路径",dataIndex:"path",key:"path"},{title:"类型",dataIndex:"type",key:"type",render:function(e){return E.default.routeType[e]}},{title:"操作",key:"action",className:"center",render:function(e){return _.default.createElement("div",null,_.default.createElement(S.default,{value:e,isNew:!1,onSuccess:a.handleEditSuccess}),_.default.createElement("span",{className:"ant-divider"}),_.default.createElement(p.default,{title:"确定取消吗?",onConfirm:function(t){return a.handleDelete(t,e)},okText:"确定",cancelText:"取消"},_.default.createElement("a",{href:"javascript:;"},"删除")),_.default.createElement("span",{className:"ant-divider"}),_.default.createElement(S.default,{value:{parent_id:e._id},isNew:!0,onSuccess:a.handleCreateSuccess}))}}];return _.default.createElement("div",null,_.default.createElement(s.default,{className:"head-action-bar"},_.default.createElement(f.default,{span:24},_.default.createElement("div",{className:"pull-right"},_.default.createElement(S.default,{value:{parent_id:0},isNew:!0,type:"button",onSuccess:this.handleSuccess})))),_.default.createElement(r.default,{tip:"加载中...",spinning:t},_.default.createElement(u.default,{columns:n,dataSource:e,onExpand:this.handleExpandChange,indentSize:30,pagination:!1})))}}]),Index}(g.default);a.default=P},n=function(e,a,n){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}t.Object.defineProperty(a,"__esModule",{value:!0});var i=n(4),r=_interopRequireDefault(i),l=n(5),u=_interopRequireDefault(l),o=n(8),s=_interopRequireDefault(o),c=n(7),f=_interopRequireDefault(c),d=n(6),p=_interopRequireDefault(d),h=n(0),m=_interopRequireDefault(h),_=n(314),y=_interopRequireDefault(_),v=n(35),b=_interopRequireDefault(v),E=n(41),D=_interopRequireDefault(E),g=n(320),k=_interopRequireDefault(g),S=function(e,a){var n={};for(var i in e)t.Object.prototype.hasOwnProperty.call(e,i)&&a.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof t.Object.getOwnPropertySymbols)for(var r=0,i=t.Object.getOwnPropertySymbols(e);r<i.length;r++)a.indexOf(i[r])<0&&(n[i[r]]=e[i[r]]);return n},P=function(e){function Popconfirm(e){(0,u.default)(this,Popconfirm);var a=(0,f.default)(this,(Popconfirm.__proto__||t.Object.getPrototypeOf(Popconfirm)).call(this,e));return a.onConfirm=function(e){a.setVisible(!1);var t=a.props.onConfirm;t&&t.call(a,e)},a.onCancel=function(e){a.setVisible(!1);var t=a.props.onCancel;t&&t.call(a,e)},a.onVisibleChange=function(e){a.setVisible(e)},a.state={visible:e.visible},a}return(0,p.default)(Popconfirm,e),(0,s.default)(Popconfirm,[{key:"componentWillReceiveProps",value:function(e){"visible"in e&&this.setState({visible:e.visible})}},{key:"getPopupDomNode",value:function(){return this.refs.tooltip.getPopupDomNode()}},{key:"setVisible",value:function(e){var t=this.props;"visible"in t||this.setState({visible:e});var a=t.onVisibleChange;a&&a(e)}},{key:"render",value:function(){var e=this.props,t=e.prefixCls,a=e.title,n=e.placement,i=e.okText,l=e.okType,u=e.cancelText,o=S(e,["prefixCls","title","placement","okText","okType","cancelText"]),s=this.getLocale(),c=m.default.createElement("div",null,m.default.createElement("div",{className:t+"-inner-content"},m.default.createElement("div",{className:t+"-message"},m.default.createElement(b.default,{type:"exclamation-circle"}),m.default.createElement("div",{className:t+"-message-title"},a)),m.default.createElement("div",{className:t+"-buttons"},m.default.createElement(D.default,{onClick:this.onCancel,size:"small"},u||s.cancelText),m.default.createElement(D.default,{onClick:this.onConfirm,type:l,size:"small"},i||s.okText))));return m.default.createElement(y.default,(0,r.default)({},o,{prefixCls:t,placement:n,onVisibleChange:this.onVisibleChange,visible:this.state.visible,overlay:c,ref:"tooltip"}))}}]),Popconfirm}(m.default.Component);P.defaultProps={prefixCls:"ant-popover",transitionName:"zoom-big",placement:"top",trigger:"click",okType:"primary"};var C=(0,k.default)("Popconfirm",{cancelText:"取消",okText:"确定"});a.default=C(P),e.exports=a.default},i=function(e,t,a){a(23),a(317),a(47)},r=function(e,a,n){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var i=(n(312),n(311)),r=_interopRequireDefault(i),l=(n(37),n(59)),u=_interopRequireDefault(l),o=(n(47),n(41)),s=_interopRequireDefault(o),c=(n(158),n(131)),f=_interopRequireDefault(c),d=(n(68),n(67)),p=_interopRequireDefault(d),h=t.Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var i in n)t.Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},m=function(){function defineProperties(e,a){for(var n=0;n<a.length;n++){var i=a[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),t.Object.defineProperty(e,i.key,i)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),_=n(0),y=_interopRequireDefault(_),v=n(313),b=_interopRequireDefault(v),E=n(114),D=_interopRequireDefault(E),g=n(22),k=_interopRequireDefault(g),S=p.default.Item,P=f.default.Option,C=function(e){function Edit(e){_classCallCheck(this,Edit);var a=_possibleConstructorReturn(this,(Edit.__proto__||t.Object.getPrototypeOf(Edit)).call(this,e));return a.state={visible:!1},["handleEdit"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(Edit,e),m(Edit,[{key:"handleEdit",value:function(){var e=this,t=this.props.form.getFieldsValue();k.default.ajax({url:this.props.isNew?k.default.authority.create():k.default.authority.edit(),type:"POST",data:t},function(t){e.props.onSuccess(t.res.detail),e.hideModal()})}},{key:"render",value:function(){var e=this.state.visible,t=this.props,a=t.value,n=t.isNew,i=t.type,l=this.props.form.getFieldDecorator,o=D.default.formItemLayout,c=D.default.selectStyle,d=n?"添加":"编辑";return y.default.createElement("span",null,"button"===i?y.default.createElement(s.default,{type:"primary",onClick:this.showModal},d):y.default.createElement("a",{href:"javascript:;",onClick:this.showModal},d),y.default.createElement(r.default,{visible:e,title:d,onCancel:this.hideModal,onOk:this.handleEdit,width:"720px"},y.default.createElement(p.default,null,l("auth_item_id",{initialValue:a._id})(y.default.createElement(u.default,{type:"hidden"})),l("parent_id",{initialValue:a.parent_id})(y.default.createElement(u.default,{type:"hidden"})),y.default.createElement(S,h({label:"名称"},o),l("name",{initialValue:a.name})(y.default.createElement(u.default,null))),y.default.createElement(S,h({label:"类型"},o),l("type",{initialValue:a.type||"0"})(y.default.createElement(f.default,c,y.default.createElement(P,{value:"0"},"路由"),y.default.createElement(P,{value:"1"},"模态框"),y.default.createElement(P,{value:"2"},"授权")))),y.default.createElement(S,h({label:"路由"},o),l("path",{initialValue:a.path})(y.default.createElement(u.default,null))),y.default.createElement(S,h({label:"备注"},o),l("remark",{initialValue:a.remark})(y.default.createElement(u.default,null))))))}}]),Edit}(b.default);C=p.default.create()(C),a.default=C},l=e,u=l.webpackJsonp;if(l.webpackJsonp!==u)throw new Error("Prepack model invariant violation: "+l.webpackJsonp);var o=[60],s={1574:a,1596:n,1597:i,2336:r};u(o,s)}).call(this);