(function(){var e=this,t=this,a=function(e,a,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}t.Object.defineProperty(a,"__esModule",{value:!0});var n=r(4),l=_interopRequireDefault(n),i=r(5),u=_interopRequireDefault(i),o=r(8),s=_interopRequireDefault(o),c=r(7),d=_interopRequireDefault(c),f=r(6),p=_interopRequireDefault(f),h=r(0),m=_interopRequireDefault(h),y=r(314),b=_interopRequireDefault(y),v=r(35),_=_interopRequireDefault(v),g=r(41),E=_interopRequireDefault(g),w=r(320),k=_interopRequireDefault(w),P=function(e,a){var r={};for(var n in e)t.Object.prototype.hasOwnProperty.call(e,n)&&a.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof t.Object.getOwnPropertySymbols)for(var l=0,n=t.Object.getOwnPropertySymbols(e);l<n.length;l++)a.indexOf(n[l])<0&&(r[n[l]]=e[n[l]]);return r},R=function(e){function Popconfirm(e){(0,u.default)(this,Popconfirm);var a=(0,d.default)(this,(Popconfirm.__proto__||t.Object.getPrototypeOf(Popconfirm)).call(this,e));return a.onConfirm=function(e){a.setVisible(!1);var t=a.props.onConfirm;t&&t.call(a,e)},a.onCancel=function(e){a.setVisible(!1);var t=a.props.onCancel;t&&t.call(a,e)},a.onVisibleChange=function(e){a.setVisible(e)},a.state={visible:e.visible},a}return(0,p.default)(Popconfirm,e),(0,s.default)(Popconfirm,[{key:"componentWillReceiveProps",value:function(e){"visible"in e&&this.setState({visible:e.visible})}},{key:"getPopupDomNode",value:function(){return this.refs.tooltip.getPopupDomNode()}},{key:"setVisible",value:function(e){var t=this.props;"visible"in t||this.setState({visible:e});var a=t.onVisibleChange;a&&a(e)}},{key:"render",value:function(){var e=this.props,t=e.prefixCls,a=e.title,r=e.placement,n=e.okText,i=e.okType,u=e.cancelText,o=P(e,["prefixCls","title","placement","okText","okType","cancelText"]),s=this.getLocale(),c=m.default.createElement("div",null,m.default.createElement("div",{className:t+"-inner-content"},m.default.createElement("div",{className:t+"-message"},m.default.createElement(_.default,{type:"exclamation-circle"}),m.default.createElement("div",{className:t+"-message-title"},a)),m.default.createElement("div",{className:t+"-buttons"},m.default.createElement(E.default,{onClick:this.onCancel,size:"small"},u||s.cancelText),m.default.createElement(E.default,{onClick:this.onConfirm,type:i,size:"small"},n||s.okText))));return m.default.createElement(b.default,(0,l.default)({},o,{prefixCls:t,placement:r,onVisibleChange:this.onVisibleChange,visible:this.state.visible,overlay:c,ref:"tooltip"}))}}]),Popconfirm}(m.default.Component);R.defaultProps={prefixCls:"ant-popover",transitionName:"zoom-big",placement:"top",trigger:"click",okType:"primary"};var C=(0,k.default)("Popconfirm",{cancelText:"取消",okText:"确定"});a.default=C(R),e.exports=a.default},r=function(e,t,a){"use strict";a(23),a(317),a(47)},n=function(e,a,r){"use strict";t.Object.defineProperty(a,"__esModule",{value:!0});var n={aftersales:{project:{destroy:"aftersales/project/destroy"},consumptiveMaterial:{examine:"aftersales/consumptive-material/examine"}},warehouse:{purchase:{import:"warehouse/purchase/import",pay:"warehouse/purchase/pay"},purchaseReject:{export:"warehouse/purchase-reject/export",pay:"warehouse/purchase-reject/pay"},stocktaking:{auth:"warehouse/stocktaking/auth",authorize:"warehouse/stocktaking/authorize",import:"warehouse/stocktaking/import"},supplier:{pay:"warehouse/supplier/pay"}},customer:{information:"customer/customer-information",auto:"customer/auto-information",insurance:"customer/insurance-information",deal:"customer/deal-information",maintenance:"customer/maintenance-information",intention:"customer/intention-information",reminder:"customer/reminder"},deal:{calculatedReturn:"presales/deal-auto/calculation-income"},maintainItem:{commission:"maintain-item/commission"},marketing:{commission:"\tmarketing/membercard/commission"}};a.default=n},l=function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDE0IDc5LjE1Njc5NywgMjAxNC8wOC8yMC0wOTo1MzowMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTI3QzI1RUMyRTRCMTFFNzlCQjVGREFERkNEMDJCNjYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTI3QzI1RUQyRTRCMTFFNzlCQjVGREFERkNEMDJCNjYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBMjdDMjVFQTJFNEIxMUU3OUJCNUZEQURGQ0QwMkI2NiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBMjdDMjVFQjJFNEIxMUU3OUJCNUZEQURGQ0QwMkI2NiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqkGoiQAAAWqSURBVHjazJhbTBxlFMe/meW6y2K5LKES2GrRwkOrGKwo+kQbL4FXwPjQJo0NwQZeIPKojwZCAvoAiQ8QmxJ4MEKaGGPQRCQmmkBLmqApBhYWFroQkL1fx/8ZZrazy87szgLaj/7Zsjvfd357zvnOd+EEQWDPcuPZM96y6Fd9fX0mfV+A3oXehmohK2SWPnNBNmgZ+hX6AVpVG2hl6c+k7x8E3UeAOpoBaoXuQG9CnMpzJZJegz6CKI9+g76CpqCImgEOP5R2HKc/xNegR9A96C0NuOR2j/rck8a4lvQpgf4J4tOCjhzMg0ahH6GaU0irGmmsUWns+K+hc5JYoF+g22eQ/7elsS2y9/TOYuo4B71+hpOUxp6rvlJjSQx1KkAjdB+6lFaCcdxJIMnG/epXaozJQq0GOAxdTdfCKRR7sjXMKcjk//NJjF3Hy63/oSbfevHyy9fF8MqzORHQ/Y/LgHANa42Sn5/P2tvbdYfVYrGw5ubmVKnyZcXFqixlHsYValNhwYdapcRoNLKhoSFWV1fHKisr2cDAQFrhJbiRkRFWVVXFzGYzm5iYUM3HPFM+vj27eywHsdyQSz7RMtTS0iLCUWtra2M9PT0pPSnDWa1W8dnOzk7xPY12h1NMkxjghdrqagzwhlbPqakpUXJLBamEo+b3+1l3dzdzOp1aYb5qra1+6Rggz/MfpFq+KJz9/f1pQSaD6+rqYgsLCymrFljel3NQBPx76S8eBhrTLSmpIE8AJ3uxEa7iFZNEMOCNWj11jyCptba2xiCpjY+PxyZEJnBSEayRdk5RjoydyynIw3KzhTeK9JQO8lhvb28MkprH42EmkylzOGkriKie3w+6/LxUc+i1QO8oycJ9CnDiMCjU/NNJwmW+9SfIsbEx0XPKNj8/zxYXF098HOEVOwhPJqPIE0L2nNyamprSqpMqG1fvsTIDlzoygRsdHY2bELOzs2nXSXU+YSsOkLpHo9GVk8JRzvX19ekq5skaWB7HAaImRiPhyO8nhaMJoaeYqzWw/EGcyhBHfW7Pz+ob7/TgMllxkkVYYokqQxxxbu6swLUPtHqWlZWlhEuEnJyc1AUJhoe7m09W5KOpHGL6IxD0B+5qATY0NIjbrHTrHEHSlkwJSbO7uLhYtU/IH/wG/QKAegqIVYTcGXSs2qfxoeoNwMzMDBscHGQ+ny/tIqyE3N3dZR0dHWxvb0/t2dWttY1phDQIiSEWlzq6+sB+MJuWuvMXKlpMheavtYyWlpaKxvQuiyUlJZr9PIfujx1r9hkkwD56hLDUxRXqMA4qXsfa5k+RUGRay5heONmTWv3CofB3gKMi6kXKhY8Vahz7MITgp4sfuPkzJOuj/+q0RLYcNvvncJIL8lOlTnpoggcpMT1BX8D5xL7dKUQE21nDCVHB5oStgNfvBIAHiqieiy9euUTgAfw6dB8cru9sOm7i2y2foeeWd+yOm+4D1zqYDqmSJNbiY7sYhJpmDy3WB4C02VdsN8Kh0LenDUdjbjxeu0E2yJZwtEGIKg/tcbM4sWHDSLttbFGEInylgvKq59/B7P6U4znrSUPqOXR9sb2+NQdfuRnNWIQWUGEKH6dwIV1gqgJKR1GDdE9TiF5mPos3llsr3ssz5rfhYHNZzx0hwrnk9/qmtm2b30cjUa94CysgrJzouUjiJSZh7qcClCB5PJ4riN4Ur3jzoeznSouqzOcKG7Oys1/lDfwF1LlyyCSVFA+0DZA1hPIBwjh/sLu/QYsB5JPgaP8ZoJQSr4CFo68r3rCKnuQY1cGUgIpDPYU8lzyKzkYMkos3szCuAX/z0hadkwwJ4oGHcZRTEXxGNTYAW17JYzQZwljBhNgdtXA8HrEQF+UUsNgNBpf8albh+yy8ZMNojgScI8EbFL3JCRF4lPIqKAHRa4gdFWFB9X5a8REB/ivAABt+/qZv1YdyAAAAAElFTkSuQmCC"},i=function(e,a,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(r(66),r(65)),l=_interopRequireDefault(n),i=(r(68),r(67)),u=_interopRequireDefault(i),o=t.Object.assign||function(e){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)t.Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=function(){function defineProperties(e,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),c=r(0),d=_interopRequireDefault(c),f=r(9),p=_interopRequireDefault(f),h=u.default.Item,m=function(e){function NumberInput(e){_classCallCheck(this,NumberInput);var a=_possibleConstructorReturn(this,(NumberInput.__proto__||t.Object.getPrototypeOf(NumberInput)).call(this,e));return a.state={unitShow:!1},["handleChange"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(NumberInput,e),s(NumberInput,[{key:"componentDidMount",value:function(){var e=this;t.setTimeout(function(){e.setState({unitShow:!0})},0)}},{key:"handleChange",value:function(e){var a=e.target.value,r=this.props,n=r.id,i=r.onChange,u=r.isInt,o="";if(t.isNaN(a))return l.default.error("只能输入大于零数字"),this[n].value="",i(""),!1;var s=a.split(".")[1];u?(a&&a.indexOf(".")>0&&l.default.warning("只能输入整数"),o=a.replace(/[^\d]/g,""),this[n].value=o):(s&&s.length>2&&l.default.warning("最多只能输入两位小数"),o=a.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"),this[n].value=o),!1===i(o)&&(this[n].value="",i(""))}},{key:"render",value:function(){var e=this,a=this.state.unitShow,r=this.props,n=r.defaultValue,l=r.id,i=r.value,u=r.style,s=r.self,c=r.placeholder,f=r.rules,m=r.layout,y=r.label,b=r.unitVisible,v=r.disabled,_=r.unit,g="",E=(0,p.default)({"number-input-addon":b&&a,hide:!b||!a});return s&&(g=s.props.form.getFieldDecorator),s?d.default.createElement("span",{ref:function(t){return e["content"+l]=t},style:u},d.default.createElement(h,o({label:y},m),g(l,{initialValue:t.String(n)||"",validateTrigger:"onBlur",rules:f})(d.default.createElement("input",{className:"ant-input ant-input-lg",ref:function(t){return e[l]=t},onInput:function(t){return e.handleChange(t)},placeholder:c,disabled:v,style:{width:"100%"}})),d.default.createElement("span",{className:E},_||"元"))):d.default.createElement("span",{ref:function(t){return e["content"+l]=t},style:t.Object.assign(u,{display:"inline-block",position:"relative"})},d.default.createElement("input",{value:i,className:"ant-input ant-input-lg",style:{width:"100%"},ref:function(t){return e[l]=t},onInput:function(t){return e.handleChange(t)},placeholder:c,disabled:v}),d.default.createElement("span",{className:E},_||"个"))}}]),NumberInput}(d.default.Component);m.defaultProps={defaultValue:"",style:{width:"100%"},isInt:!1,placeholder:"",rules:"",layout:{labelCol:{span:8},wrapperCol:{span:16}},label:"",unit:"",unitVisible:!0,onChange:function(){}},a.default=m},u=function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDE0IDc5LjE1Njc5NywgMjAxNC8wOC8yMC0wOTo1MzowMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MjhFNEFDNzUyN0RDMTFFNzg5MEM5NTM3NDkyMzU4RTIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MjhFNEFDNzYyN0RDMTFFNzg5MEM5NTM3NDkyMzU4RTIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoyOEU0QUM3MzI3REMxMUU3ODkwQzk1Mzc0OTIzNThFMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoyOEU0QUM3NDI3REMxMUU3ODkwQzk1Mzc0OTIzNThFMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PhelemwAAAz4SURBVHja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"},o=function(e,a,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(r(312),r(311)),l=_interopRequireDefault(n),i=(r(49),r(48)),u=_interopRequireDefault(i),o=(r(51),r(50)),s=_interopRequireDefault(o),c=(r(37),r(59)),d=_interopRequireDefault(c),f=(r(157),r(35)),p=_interopRequireDefault(f),h=(r(66),r(65)),m=_interopRequireDefault(h),y=function(){function defineProperties(e,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),b=r(0),v=_interopRequireDefault(b),_=r(313),g=_interopRequireDefault(_),E=r(22),w=_interopRequireDefault(E);r(1759);var k=function(e){function Type(e){_classCallCheck(this,Type);var a=_possibleConstructorReturn(this,(Type.__proto__||t.Object.getPrototypeOf(Type)).call(this,e));return a.state={superPartVisible:!1,superPartList:[],secondPartList:[],secondPartName:"",superPartListOne:[],superPartListTwo:[]},["handleSecondPartClick","handleShowSuper","handleHideSuper","handleDelete","handleCancel"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(Type,e),y(Type,[{key:"componentDidMount",value:function(){this.getSuperPartTypeList()}},{key:"componentWillReceiveProps",value:function(e){e.defaultValue&&(this.state.secondPartName||this.setState({secondPartName:e.defaultValue}))}},{key:"handleSecondPartClick",value:function(e,t){this.setState({secondPartName:t+"/"+e.name,superPartVisible:!1}),this.props.onSuccess(e._id,e,this.handleCancel,t)}},{key:"handleCancel",value:function(){this.setState({secondPartName:""})}},{key:"handleShowSuper",value:function(){this.setState({superPartVisible:!0})}},{key:"handleHideSuper",value:function(){this.setState({superPartVisible:!1})}},{key:"handleDelete",value:function(){this.setState({secondPartName:""}),this.props.onSuccess("")}},{key:"getSuperPartTypeList",value:function(){var e=this;w.default.ajax({url:w.default.warehouse.category.partAllPartTypes()},function(t){var a=t.res.list.slice(0,6),r=t.res.list.slice(6,11);e.setState({superPartListOne:a,superPartListTwo:r})},function(e){m.default.error("获取列表数据失败["+e+"]")})}},{key:"render",value:function(){var e=this,t=this.state,a=t.superPartVisible,r=t.secondPartName,n=t.superPartListOne,i=t.superPartListTwo;return v.default.createElement("span",null,v.default.createElement(d.default,{placeholder:"请选择",onClick:this.handleShowSuper,value:r,style:this.props.style,size:"large",suffix:v.default.createElement(p.default,{type:"close-circle-o",className:r?"":"hide",onClick:this.handleDelete}),ref:function(t){return e.partType=t}}),v.default.createElement(l.default,{title:"请选择配件分类",visible:a,footer:null,onCancel:this.handleHideSuper,width:720},v.default.createElement(u.default,{className:"mb20"},n.map(function(t){return v.default.createElement(s.default,{key:t._id+t.name,span:4},v.default.createElement("div",{className:"super-type"},t.name),t.sub_list.map(function(a){return v.default.createElement("div",{className:"second-type",key:a._id+a.name,onClick:function(){return e.handleSecondPartClick(a,t.name)}},a.name)}))})),v.default.createElement(u.default,null,i.map(function(t){return v.default.createElement(s.default,{key:t._id+t.name,span:4},v.default.createElement("div",{className:"super-type"},t.name),t.sub_list.map(function(a){return v.default.createElement("div",{className:"second-type",key:a._id+a.name,onClick:function(){return e.handleSecondPartClick(a,t.name)}},a.name)}))}),v.default.createElement(s.default,{span:4},v.default.createElement("div",{className:"super-type"})))))}}]),Type}(g.default);a.default=k},s=function(e,t,a){t=e.exports=a(14)(),t.push([e.i,".super-type {\n  font-size: 14px;\n  background-color: #f1f1f1;\n  height: 34px;\n  line-height: 34px;\n  text-align: center;\n  margin: 5px -16px;\n}\n.second-type {\n  height: 26px;\n  line-height: 26px;\n  text-align: center;\n  font-size: 14px;\n}\n.second-type:hover {\n  color: #108ee9;\n  cursor: pointer;\n}\n",""])},c=function(e,a,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(r(49),r(48)),l=_interopRequireDefault(n),i=(r(51),r(50)),u=_interopRequireDefault(i),o=(r(68),r(67)),s=_interopRequireDefault(o),c=t.Object.assign||function(e){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)t.Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d=function(){function defineProperties(e,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),f=r(0),p=_interopRequireDefault(f),h=r(114),m=_interopRequireDefault(h),y=s.default.Item,b=function(e){function Help(){return _classCallCheck(this,Help),_possibleConstructorReturn(this,(Help.__proto__||t.Object.getPrototypeOf(Help)).apply(this,arguments))}return _inherits(Help,e),d(Help,[{key:"render",value:function(){var e=this.props.partInfo,a={};e&&(a=e.info);var r={display:"none"};e&&(r={position:"absolute",width:"850px",border:"1px solid rgba(16, 142, 233, 1)",paddingTop:"10px",left:e.coordinate.left+"px"||"",top:e.coordinate.top+10+"px"||"",display:e.visible?"":"none",backgroundColor:"white",zIndex:100,borderRadius:"6px"});var n=m.default.formItemLayout_1014;return p.default.createElement("div",{style:r},p.default.createElement(l.default,null,p.default.createElement(u.default,{span:6,offset:1},p.default.createElement(y,c({label:"配件名"},n),a.part_name||a.name)),p.default.createElement(u.default,{span:6},p.default.createElement(y,c({label:"配件号"},n),a.part_no)),p.default.createElement(u.default,{span:6},p.default.createElement(y,c({label:"规格"},n),a.spec||a.part_spec,a.unit||a.part_unit))),p.default.createElement(l.default,null,p.default.createElement(u.default,{span:6,offset:1},p.default.createElement(y,c({label:"品牌"},n),a.brand)),p.default.createElement(u.default,{span:6},p.default.createElement(y,c({label:"适用车型"},n),a.scope)),p.default.createElement(u.default,{span:6},p.default.createElement(y,c({label:"配件分类"},n),a.part_type_name))),p.default.createElement(l.default,null,p.default.createElement(u.default,{span:6,offset:1},p.default.createElement(y,c({label:"库存数"},n),a.remain_amount||a.part_amount||a.amount)),p.default.createElement(u.default,{span:6},p.default.createElement(y,c({label:"冻结数"},n),a.freeze||a.part_freeze)),p.default.createElement(u.default,{span:6},p.default.createElement(y,c({label:"安全库存"},n),a.min_amount)),p.default.createElement(u.default,{span:5},p.default.createElement(y,c({label:"加价率"},n),a.markup_rate?100*t.Number(a.markup_rate)+"%":"0%"))),p.default.createElement(l.default,null,p.default.createElement(u.default,{span:6,offset:1},p.default.createElement(y,c({label:"当前进价"},n),t.Number(a.in_price).toFixed(2))),p.default.createElement(u.default,{span:6},p.default.createElement(y,c({label:"最低进价"},n),t.Number(a.min_in_price).toFixed(2))),p.default.createElement(u.default,{span:6},p.default.createElement(y,c({label:"当前售价"},n),t.Number(a.sell_price||a.material_fee_base).toFixed(2))),p.default.createElement(u.default,{span:5},p.default.createElement(y,c({label:"最低售价"},n),a.in_price?(a.in_price*(1+(t.Number(a.markup_rate)||0))).toFixed(2):""))))}}]),Help}(f.Component);a.default=b},d=function(e,t,a){var r=a(1756);"string"==typeof r&&(r=[[e.i,r,""]]);a(15)(r,{});r.locals&&(e.exports=r.locals)},f=function(e,a,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(r(312),r(311)),l=_interopRequireDefault(n),i=(r(49),r(48)),u=_interopRequireDefault(i),o=(r(51),r(50)),s=_interopRequireDefault(o),c=(r(157),r(35)),d=_interopRequireDefault(c),f=(r(47),r(41)),p=_interopRequireDefault(f),h=(r(66),r(65)),m=_interopRequireDefault(h),y=(r(37),r(59)),b=_interopRequireDefault(y),v=(r(158),r(131)),_=_interopRequireDefault(v),g=(r(68),r(67)),E=_interopRequireDefault(g),w=t.Object.assign||function(e){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)t.Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k=function(){function defineProperties(e,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),P=r(0),R=_interopRequireDefault(P),C=r(22),j=_interopRequireDefault(C),S=r(114),I=_interopRequireDefault(S),N=r(116),x=_interopRequireDefault(N),D=r(313),A=_interopRequireDefault(D),O=r(1745),M=_interopRequireDefault(O),q=E.default.Item,T=_.default.Option,z=b.default.TextArea,F=function(e){function NewPart(e){_classCallCheck(this,NewPart);var a=_possibleConstructorReturn(this,(NewPart.__proto__||t.Object.getPrototypeOf(NewPart)).call(this,e));return a.state={visible:!1,types:[],partId:"",partCategories:[]},["handleNewPart","handleSearch","handleSearchSelect","handleSubmit","handleChoosePartType"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(NewPart,e),k(NewPart,[{key:"handleNewPart",value:function(){this.getMaintainItemTypes(),this.showModal()}},{key:"handleSearch",value:function(e,t,a){var r=this;e&&j.default.ajax({url:j.default.warehouse.category.search(e)},function(e){t(e.res.list),r.setState({partCategories:e.res.list})},function(e){a(e),r.setState({partCategories:[]})})}},{key:"handleSearchSelect",value:function(e){this.setState({part_type:e._id})}},{key:"handleChoosePartType",value:function(e){this.setState({partId:e})}},{key:"handleSubmit",value:function(){var e=this;this.props.form.validateFieldsAndScroll(function(a,r){if(a)return void m.default.warning("请完善表单信息");var n=e.state.partId;if(!n)return void m.default.warning("请选择配件分类");r.part_type=n,r.markup_rate=t.Number(r.markup_rate)/100,j.default.ajax({url:j.default.warehouse.part.add(),type:"POST",data:r},function(t){m.default.success("添加成功！"),e.props.onSuccess(t.res.auto_part),e.props.form.resetFields(),e.hideModal()})})}},{key:"hideModal",value:function(){this.setState({visible:!1}),this.props.form.resetFields()}},{key:"getMaintainItemTypes",value:function(){var e=this;j.default.ajax({url:j.default.aftersales.getMaintainItemTypes()},function(t){e.setState({types:t.res.type_list})})}},{key:"render",value:function(){var e=I.default.formItemLayout,t=I.default.formItemLayoutHalf,a=this.props.form.getFieldDecorator,r=this.state.visible;return R.default.createElement("span",null,R.default.createElement(p.default,{type:"primary",onClick:this.handleNewPart},"创建配件"),R.default.createElement(l.default,{title:R.default.createElement("span",null,R.default.createElement(d.default,{type:"plus"})," 创建配件"),visible:r,onCancel:this.hideModal,onOk:this.handleSubmit,width:720,style:{zIndex:"9999"}},R.default.createElement(E.default,null,R.default.createElement(u.default,null,R.default.createElement(s.default,{span:12},R.default.createElement(q,w({label:"配件名称"},e),a("name",{initialValue:this.props.inputValue,rules:x.default.getRulePartName(),validateTrigger:"onBlur"})(R.default.createElement(b.default,{placeholder:"请输入配件名称"})))),R.default.createElement(s.default,{span:12},R.default.createElement(q,w({label:"配件号"},e),a("part_no",{rules:x.default.getRulePartNo(),validateTrigger:"onBlur"})(R.default.createElement(b.default,{placeholder:"请输入配件号"}))))),R.default.createElement(u.default,null,R.default.createElement(s.default,{span:12},R.default.createElement(q,w({label:"规格"},e),a("spec",{initialValue:"1"})(R.default.createElement(b.default,{addonAfter:a("unit",{initialValue:"个"})(R.default.createElement(_.default,{style:{width:45}},R.default.createElement(T,{value:"个"},"个"),R.default.createElement(T,{value:"升"},"升"),R.default.createElement(T,{value:"瓶"},"瓶"),R.default.createElement(T,{value:"件"},"件"),R.default.createElement(T,{value:"副"},"副"),R.default.createElement(T,{value:"根"},"根"),R.default.createElement(T,{value:"条"},"条"))),placeholder:"请输入规格"})))),R.default.createElement(s.default,{span:12},R.default.createElement(q,w({label:"配件品牌"},e),a("brand")(R.default.createElement(b.default,{placeholder:"请输入配件品牌"}))))),R.default.createElement(u.default,null,R.default.createElement(s.default,{span:12},R.default.createElement(q,w({label:"适用车型"},e),a("scope")(R.default.createElement(b.default,{placeholder:"请输入适用车型"})))),R.default.createElement(s.default,{span:12},R.default.createElement(q,w({label:"配件分类"},e,{required:!0}),R.default.createElement(M.default,{onSuccess:this.handleChoosePartType})))),R.default.createElement(u.default,null,R.default.createElement(s.default,{span:12},R.default.createElement(q,w({label:"安全库存"},e),a("min_amount")(R.default.createElement(b.default,{placeholder:"请输入安全库存"})))),R.default.createElement(s.default,{span:12},R.default.createElement(q,w({label:"加价率"},e),a("markup_rate")(R.default.createElement(b.default,{placeholder:"请输入加价率",addonAfter:"%",style:{width:"200px"}}))))),R.default.createElement(u.default,null,R.default.createElement(s.default,{span:24},R.default.createElement(q,w({label:"备注"},t),a("remark",{initialValue:""})(R.default.createElement(z,{placeholder:"请输入备注"}))))))))}}]),NewPart}(A.default);F=E.default.create()(F),a.default=F},p=function(e,a,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(r(628),r(627)),l=_interopRequireDefault(n),i=function(){function defineProperties(e,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),u=r(0),o=_interopRequireDefault(u),s=r(1763),c=_interopRequireDefault(s),d=r(1696),f=r(1673),p=function(e){function SearchDropDown(e){_classCallCheck(this,SearchDropDown);var a=_possibleConstructorReturn(this,(SearchDropDown.__proto__||t.Object.getPrototypeOf(SearchDropDown)).call(this,e));return a.state={partsInfo:""},["handleTableRow","handleCancel","handleSuccess","eventListenerFun"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(SearchDropDown,e),i(SearchDropDown,[{key:"componentDidMount",value:function(){t.document.addEventListener("click",this.eventListenerFun,!1)}},{key:"componentWillReceiveProps",value:function(e){var a=this;e.partsInfo&&(e.partsInfo.visible&&t.document.addEventListener("click",this.eventListenerFun,!1),this.setState({partsInfo:e.partsInfo},function(){e.partsInfo.keyword||a.handleCancel()}))}},{key:"componentWillUnmount",value:function(){t.document.removeEventListener("click",this.eventListenerFun,!1)}},{key:"handleTableRow",value:function(e){this.handleCancel(),this.props.onTableRowClick(e),this.props.onCancel&&this.props.onCancel()}},{key:"handleCancel",value:function(){var e=this.state.partsInfo;e.visible=!1,t.document.removeEventListener("click",this.eventListenerFun,!1),this.setState({partsInfo:e}),this.props.onCancel&&this.props.onCancel()}},{key:"handleSuccess",value:function(e){this.props.onTableRowClick(e)}},{key:"handleClick",value:function(e){e.nativeEvent.stopImmediatePropagation()}},{key:"eventListenerFun",value:function(){var e=this.state.partsInfo;e||(e={}),e.visible=!1,this.setState({partsInfo:e}),this.handleCancel()}},{key:"render",value:function(){var e=this.state.partsInfo,a=this.props.isInsertPart,r=e.info?e.info:[],n=r&&0===r.length?"210px":"800px";r&&0===r.length&&(n="false"===a?"800px":"210px");var i=[{title:"配件名",dataIndex:"name",key:"name",width:"20%"},{title:"配件号",dataIndex:"part_no",key:"part_no",width:"20%"},{title:"规格",dataIndex:"spec",key:"spec",width:"15%",render:function(e,t){return""+e+t.unit}},{title:"品牌",dataIndex:"brand",key:"brand",width:"10%"},{title:"适用车型",dataIndex:"scope",key:"scope",width:"20%"},{title:"剩余库存",dataIndex:"amount",key:"amount",width:"15%",render:function(e,a){return t.Number(e)-t.Number(a.freeze)}}],u={display:"none"};return e.coordinate&&(u={position:"absolute",width:n,left:e.coordinate.left+"px"||"",top:e.coordinate.top+10+"px"||"",display:e.visible?"":"none",zIndex:9998,backgroundColor:"white"}),o.default.createElement("div",{style:u,onClick:this.handleClick},o.default.createElement("img",{src:f,className:"close",onClick:this.handleCancel}),"false"!==a&&r&&0===r.length?o.default.createElement("div",{className:"padding-20 center",style:{boxShadow:"0 0 4px #cccccc"}},o.default.createElement("img",{src:d,style:{width:"40px",height:"40px"}}),o.default.createElement("p",null,"暂时没有找到该配件，请更换关键字查询或创建新配件"),o.default.createElement("div",{className:"mt10"},o.default.createElement(c.default,{onSuccess:this.handleSuccess,hideModal:this.handleCancel,inputValue:e.keyword}))):o.default.createElement(l.default,{dataSource:r,columns:i,size:"small",bordered:!1,pagination:!1,onRowClick:this.handleTableRow,rowKey:function(e){return e._id},scroll:{y:200}}))}}]),SearchDropDown}(u.Component);a.default=p},h=function(e,a,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var a=e.apply(this,arguments);return new t.Promise(function(e,r){function step(n,l){try{var i=a[n](l),u=i.value}catch(e){return void r(e)}if(!i.done)return t.Promise.resolve(u).then(function(e){step("next",e)},function(e){step("throw",e)});e(u)}return step("next")})}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(r(312),r(311)),l=_interopRequireDefault(n),i=(r(49),r(48)),u=_interopRequireDefault(i),o=(r(51),r(50)),s=_interopRequireDefault(o),c=(r(157),r(35)),d=_interopRequireDefault(c),f=(r(47),r(41)),p=_interopRequireDefault(f),h=(r(66),r(65)),m=_interopRequireDefault(h),y=(r(158),r(131)),b=_interopRequireDefault(y),v=(r(68),r(67)),_=_interopRequireDefault(v),g=t.Object.assign||function(e){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)t.Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},E=function(){function defineProperties(e,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),w=r(0),k=_interopRequireDefault(w),P=r(635),R=_interopRequireDefault(P),C=r(22),j=_interopRequireDefault(C),S=r(1615),I=_interopRequireDefault(S),N=r(114),x=_interopRequireDefault(N),D=r(313),A=_interopRequireDefault(D),O=_.default.Item,M=b.default.Option,q=function(e){function AuthPay(e){_classCallCheck(this,AuthPay);var a=_possibleConstructorReturn(this,(AuthPay.__proto__||t.Object.getPrototypeOf(AuthPay)).call(this,e));return a.state={detail:e.detail||{}},a.handleShow=a.handleShow.bind(a),a.handleCancel=a.handleCancel.bind(a),a.handlePay=a.handlePay.bind(a),a}return _inherits(AuthPay,e),E(AuthPay,[{key:"componentWillUnmount",value:function(){t.clearInterval(this.interval)}},{key:"handleShow",value:function(){var e=this.props.detail;if("1"!==t.String(e.status))return void m.default.error("请先入库采购单，再结算");this.checkPermission(I.default.warehouse.purchaseReject.pay),this.showModal()}},{key:"handleCancel",value:function(){t.clearInterval(this.interval),this.hideModal()}},{key:"handlePay",value:function(e){e.preventDefault();var a=this.props.form.getFieldsValue();a.reject_id=this.props.id,j.default.ajax({url:j.default.warehouse.reject.pay(),type:"post",data:a},function(e){var a=e.res.detail;"2"===t.String(a.pay_status)&&(m.default.success("支付成功"),t.setTimeout(function(){t.location.href="/warehouse/purchase-reject/index"},500))},function(e){m.default.error(e)})}},{key:"checkPermission",value:function(){function checkPermission(t){return e.apply(this,arguments)}var e=_asyncToGenerator(t.regeneratorRuntime.mark(function _callee(e){var a,r;return t.regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=this.props.id,n.next=3,j.default.checkPermission(e);case 3:r=n.sent,r?this.getRejectDetail(a):this.interval=t.setInterval(this.getRejectDetail.bind(this,a),2e3),this.setState({hasPermission:r});case 6:case"end":return n.stop()}},_callee,this)}));return checkPermission}()},{key:"getRejectDetail",value:function(e){var a=this;j.default.ajax({url:j.default.warehouse.reject.detail(e)},function(e){var r=e.res.detail;a.setState({detail:r}),"2"===t.String(r.pay_status)&&(m.default.success("支付成功"),t.clearInterval(a.interval),t.location.href="/warehouse/purchase-reject/index")})}},{key:"render",value:function(){var e=x.default.formItemTwo,a=x.default.selectStyle,r=this.props,n=r.id,i=r.disabled,o=r.form,c=r.size,f=this.state,h=f.visible,m=f.hasPermission,y=f.detail,v=o.getFieldDecorator,E=o.getFieldValue,w=t.String(y.pay_status);return k.default.createElement("span",null,"small"===c?k.default.createElement("a",{href:"javascript:;",onClick:this.handleShow},"结算"):k.default.createElement(p.default,{type:"primary",onClick:this.handleShow,disabled:i},"结算"),k.default.createElement(l.default,{title:k.default.createElement("span",null,k.default.createElement(d.default,{type:"eye"})," 退货单结算"),visible:h,maskClosable:!1,onCancel:this.handleCancel,footer:m?k.default.createElement("span",null,k.default.createElement(p.default,{size:"large",className:"mr5",onClick:this.handleCancel},"取消"),k.default.createElement(p.default,{size:"large",type:"primary",onClick:this.handlePay},"结算")):null},k.default.createElement(u.default,{type:"flex",align:"middle"},k.default.createElement(s.default,{span:12},k.default.createElement(_.default,null,k.default.createElement(O,g({label:"供应商"},e),k.default.createElement("p",null,y.supplier_company)),k.default.createElement(O,g({label:"退货金额"},e),k.default.createElement("p",null,y.old_worth,"元")),k.default.createElement(O,g({label:"退款金额"},e),k.default.createElement("p",null,y.new_worth,"元")),k.default.createElement(O,g({label:"退款差价"},e),k.default.createElement("p",null,y.diff_worth,"元")),k.default.createElement(O,g({label:"支付方式"},e),v("pay_type",{initialValue:"2"})(k.default.createElement(b.default,a,k.default.createElement(M,{key:"1"},"银行转账"),k.default.createElement(M,{key:"2"},"现金支付")))))),k.default.createElement(s.default,{span:12,className:m?"hide":null},k.default.createElement("div",{className:"center"},k.default.createElement(R.default,{value:t.JSON.stringify({authType:"reject_pay",requestParams:{type:"post",url:j.default.warehouse.reject.pay(),data:{reject_id:n,pay_type:E("pay_type")}}}),size:128,ref:"qrCode"}),k.default.createElement("p",null,"请扫码确认支付"),k.default.createElement("p",null,k.default.createElement(d.default,{type:"check-circle",className:"2"===w?"confirm-check":"hide"})))))))}}]),AuthPay}(A.default);q.defaultProps={size:"default"},q=_.default.create()(q),a.default=q},m=function(e,a,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(r(312),r(311)),l=_interopRequireDefault(n),i=(r(49),r(48)),u=_interopRequireDefault(i),o=(r(51),r(50)),s=_interopRequireDefault(o),c=(r(47),r(41)),d=_interopRequireDefault(c),f=(r(66),r(65)),p=_interopRequireDefault(f),h=(r(37),r(59)),m=_interopRequireDefault(h),y=function(){function defineProperties(e,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),b=r(0),v=_interopRequireDefault(b),_=r(22),g=_interopRequireDefault(_),E=r(1694),w=_interopRequireDefault(E),k=r(313),P=_interopRequireDefault(k),R=r(198),C=_interopRequireDefault(R),j=r(1786),S=_interopRequireDefault(j),I=m.default.Search,N=function(e){function AddPart(e){_classCallCheck(this,AddPart);var a=_possibleConstructorReturn(this,(AddPart.__proto__||t.Object.getPrototypeOf(AddPart)).call(this,e));return a.state={visible:!1,supplierId:e.supplierId,page:1,list:[],total:0,itemMap:new t.Map,partsInfo:"",key:""},["showPartModal","handlePageChange","handleComplete","handleContinueAdd","handleInPriceChange","handleCountChange","handlePartsSearch","handTableRowClick"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(AddPart,e),y(AddPart,[{key:"componentWillReceiveProps",value:function(e){var t=e.supplierId;this.props.supplierId!==t&&this.setState({supplierId:t})}},{key:"showPartModal",value:function(){var e=this.props.supplierId,t=this.state.itemMap;if(!e)return void p.default.warning("请选择供应商");t.clear();var a=[];this.setState({itemMap:t,list:a,key:""}),this.showModal()}},{key:"handlePageChange",value:function(e){this.setState({page:e})}},{key:"handlePartsSearch",value:function(e){var t=this,a=g.default.getPosition(e),r=e.target.value;this.setState({key:r}),r.length>=1&&g.default.ajax({url:g.default.warehouse.part.searchBySupplierId(r,this.state.supplierId)},function(e){var n=e.res.list,l={};l.info=n,l.coordinate=a,l.visible=!0,l.keyword=r,t.setState({partsInfo:l})})}},{key:"handleItemChange",value:function(e,a,r){if(0===t.String(r).length)return!1;var n=this.state.itemMap;if(t.parseInt(r,10)>t.parseFloat(e["reject_count"===a?"remain_amount":"in_price"])){if(n.has(e.purchase_item_id)){n.get(e.purchase_item_id)[a]=""}return p.default.warning("reject_count"===a?"退货数量不能大于进货数量":"退货单价不能大于进货价",3),!1}if(n.has(e.purchase_item_id)){n.get(e.purchase_item_id)[a]=r}return this.setState({itemMap:n}),!0}},{key:"handleComplete",value:function(){this.saveItems()&&this.setState({visible:!1,list:[]})}},{key:"handleContinueAdd",value:function(){if(this.saveItems()){var e=this.state.itemMap;e.clear();var t=[];this.setState({itemMap:e,list:t,key:"",total:0})}}},{key:"handleInPriceChange",value:function(e){var t=e.target.value;this.setState({price:t||""})}},{key:"handleCountChange",value:function(e){var t=e.target.value;this.setState({count:t||""})}},{key:"handTableRowClick",value:function(e){this.getPurchaseItemsBySupplierAndPart(e)}},{key:"saveItems",value:function(){var e=this.state.itemMap,a=[];return e.forEach(function(e){e.reject_count&&e.reject_price&&(t.parseInt(e.reject_count,10)<=t.parseInt(e.amount,10)||t.parseFloat(e.reject_price)<=t.parseFloat(e.in_price))&&a.push(e)}),0===a.length?(p.default.warning("请完善配件信息"),!1):(this.props.onAdd(a),!0)}},{key:"getPurchaseItemsBySupplierAndPart",value:function(e){var a=this,r=this.state,n=r.supplierId,l=r.page;g.default.ajax({url:g.default.warehouse.purchase.itemsBySupplierAndPart(e._id,n,l)},function(r){var n=r.res,l=n.list,i=n.total;if(0===l.length)return void p.default.warning("暂无该供应商的进货信息",3);var u=new t.Map;l.map(function(t){t.purchase_item_id=t._id,t.purchase_price=t.in_price,t.part_type_name=e.part_type_name,t.part_name=e.name,t.part_no=e.part_no,t.scope=e.scope,t.brand=e.brand,t._id="0",t.spec=e.spec,t.unit=e.unit,u.set(t.purchase_item_id,t)}),a.setState({list:l,total:t.parseInt(i,10),itemMap:u})})}},{key:"render",value:function(){var e=this.state,t=e.visible,a=e.list,r=e.total,n=e.page,i=e.itemMap,o=e.partsInfo,c=e.key,f=this,p=[{title:"采购单号",dataIndex:"purchase_item_id",key:"purchase_item_id"},{title:"入库时间",dataIndex:"arrival_time",key:"arrival_time"},{title:"库存数量",dataIndex:"remain_amount",key:"remain_amount"},{title:"单价",dataIndex:"in_price",key:"in_price"},{title:"退货数量",dataIndex:"purchase_item_id",key:"reject_count",className:"center",width:"100px",render:function(e,t){return v.default.createElement(w.default,{style:{margin:"-6px"},id:"reject_count",unitVisible:!1,isInt:!0,onChange:f.handleItemChange.bind(f,t,"reject_count")})}},{title:"退货单价",dataIndex:"purchase_item_id",key:"reject_price",className:"center",width:"100px",render:function(e,t){return v.default.createElement(w.default,{style:{margin:"-6px"},id:"reject_count",unitVisible:!1,onChange:f.handleItemChange.bind(f,t,"reject_price")})}}],h=v.default.createElement("span",null,v.default.createElement(d.default,{type:"ghost",size:"large",onClick:this.handleComplete,disabled:0===i.size},"完成"),v.default.createElement(d.default,{type:"primary",size:"large",onClick:this.handleContinueAdd,disabled:0===i.size},"继续添加"));return v.default.createElement("div",null,v.default.createElement(S.default,{partsInfo:o,onTableRowClick:this.handTableRowClick,isInsertPart:"false"}),v.default.createElement(d.default,{onClick:this.showPartModal},"添加配件"),v.default.createElement(l.default,{title:"添加配件",visible:t,width:960,maskCloseable:!0,onCancel:this.hideModal,footer:h},v.default.createElement(u.default,{className:"mb10"},v.default.createElement(s.default,{span:8},v.default.createElement("label",{className:"label"},"搜索配件"),v.default.createElement(I,{placeholder:"用关键字或编号搜索配件",style:{width:210},onChange:this.handlePartsSearch,size:"large",value:c}))),v.default.createElement(C.default,{columns:p,dataSource:a,total:r,currentPage:n,onPageChange:this.handlePageChange,rowKey:function(e){return e.purchase_item_id}})))}}]),AddPart}(P.default);a.default=N},y=function(e,a,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var a=e.apply(this,arguments);return new t.Promise(function(e,r){function step(n,l){try{var i=a[n](l),u=i.value}catch(e){return void r(e)}if(!i.done)return t.Promise.resolve(u).then(function(e){step("next",e)},function(e){step("throw",e)});e(u)}return step("next")})}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(r(317),r(324)),l=_interopRequireDefault(n),i=(r(1597),r(1596)),u=_interopRequireDefault(i),o=(r(47),r(41)),s=_interopRequireDefault(o),c=(r(157),r(35)),d=_interopRequireDefault(c),f=(r(66),r(65)),p=_interopRequireDefault(f),h=function(){function defineProperties(e,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),m=r(0),y=_interopRequireDefault(m),b=r(635),v=_interopRequireDefault(b),_=r(22),g=_interopRequireDefault(_),E=r(1615),w=_interopRequireDefault(E),k=function(e){function AuthExport(e){_classCallCheck(this,AuthExport);var a=_possibleConstructorReturn(this,(AuthExport.__proto__||t.Object.getPrototypeOf(AuthExport)).call(this,e));return a.state={visible:!1,hasPermission:!1,detail:{}},a.handleAuthPrepare=a.handleAuthPrepare.bind(a),a.handleSubmit=a.handleSubmit.bind(a),a}return _inherits(AuthExport,e),h(AuthExport,[{key:"componentDidMount",value:function(){this.checkPermission(w.default.warehouse.purchaseReject.export)}},{key:"componentWillUnmount",value:function(){t.clearInterval(this.interval)}},{key:"handleAuthPrepare",value:function(e){var a=this.props.id;e?this.interval=t.setInterval(this.getPurchaseDetail.bind(this,a),2e3):t.clearInterval(this.interval),this.setState({visible:e})}},{key:"handleSubmit",value:function(e){e.preventDefault(),g.default.ajax({url:g.default.warehouse.reject.export(),type:"post",data:{reject_id:this.props.id}},function(e){var a=e.res.detail;"0"!==t.String(a.export_user_id)&&(p.default.success("出库成功"),t.setTimeout(function(){t.location.href="/warehouse/purchase-reject/index"},500))},function(e){p.default.error("出库失败["+e+"]")})}},{key:"getPurchaseDetail",value:function(e){var a=this;g.default.ajax({url:g.default.warehouse.reject.detail(e)},function(e){var r=e.res.detail;a.setState({detail:r}),"0"!==t.String(r.export_user_id)&&(p.default.success("出库成功"),t.clearInterval(a.interval),t.location.href="/warehouse/purchase-reject/index")},function(e){p.default.error("出库失败["+e+"]"),t.clearInterval(a.interval)})}},{key:"checkPermission",value:function(){function checkPermission(t){return e.apply(this,arguments)}var e=_asyncToGenerator(t.regeneratorRuntime.mark(function _callee(e){var a;return t.regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.default.checkPermission(e);case 2:a=t.sent,this.setState({hasPermission:a});case 4:case"end":return t.stop()}},_callee,this)}));return checkPermission}()},{key:"render",value:function(){var e=this.props,a=e.id,r=e.disabled,n=this.state,i=n.hasPermission,o=n.detail,c=o.export_user_id,f=y.default.createElement("div",{className:"center"},y.default.createElement(v.default,{value:t.JSON.stringify({authType:"reject_export",requestParams:{type:"post",url:g.default.warehouse.reject.export(),data:{reject_id:a}}}),size:128,ref:"qrCode"}),y.default.createElement("p",null,"请扫码确认"),y.default.createElement("p",null,"该采购单配件出库"),y.default.createElement("p",null,y.default.createElement(d.default,{type:"check-circle",className:c&&"0"!==c?"confirm-check":"hide"})));return i?y.default.createElement(u.default,{placement:"topRight",title:"确定要出库吗",onConfirm:this.handleSubmit},y.default.createElement(s.default,{type:"primary",disabled:r},"出库")):y.default.createElement(l.default,{content:f,title:"",trigger:"click",visible:this.state.visible,onVisibleChange:this.handleAuthPrepare},y.default.createElement(s.default,{type:"primary",disabled:r},"审核出库"))}}]),AuthExport}(y.default.Component);a.default=k},b=function(e,a,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(r(47),r(41)),l=_interopRequireDefault(n),i=(r(49),r(48)),u=_interopRequireDefault(i),o=(r(51),r(50)),s=_interopRequireDefault(o),c=(r(629),r(314)),d=_interopRequireDefault(c),f=(r(66),r(65)),p=_interopRequireDefault(f),h=(r(37),r(59)),m=_interopRequireDefault(h),y=(r(158),r(131)),b=_interopRequireDefault(y),v=(r(68),r(67)),_=_interopRequireDefault(v),g=t.Object.assign||function(e){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)t.Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},E=function(){function defineProperties(e,a){for(var r=0;r<a.length;r++){var n=a[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),w=r(0),k=_interopRequireDefault(w),P=r(132),R=r(22),C=_interopRequireDefault(R),j=r(114),S=_interopRequireDefault(j),I=r(116),N=_interopRequireDefault(I),x=r(198),D=_interopRequireDefault(x),A=r(2348),O=_interopRequireDefault(A),M=r(1826),q=_interopRequireDefault(M),T=r(2349),z=_interopRequireDefault(T),F=r(1757),G=_interopRequireDefault(F),L=_.default.Item,V=b.default.Option,J=m.default.TextArea,Z=function(e){function New(e){_classCallCheck(this,New);var a=_possibleConstructorReturn(this,(New.__proto__||t.Object.getPrototypeOf(New)).call(this,e)),r=e.match.params.id;return a.state={isNew:!r,id:r||0,page:1,supplierId:"",suppliers:[],oldItemIdSet:new t.Set,delItemIdSet:new t.Set,itemMap:new t.Map,detail:{},total:0,partsInfo:"",enterPartInfo:""},["handleSupplierChange","handlePartAdd","handlePartDelete","handlePageChange","handleSubmit","handleShowPartsInfo","handlePartEnter","handlePartLeave"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(New,e),E(New,[{key:"componentDidMount",value:function(){var e=this.state,t=e.id,a=e.page;this.getSuppliers(),t&&(this.getRejectDetail(t),this.getRejectItems(t,a))}},{key:"handlePartEnter",value:function(e,t){var a={};a.coordinate=C.default.getOffsetParentPosition(e),a.info=t,a.visible=!0,this.setState({enterPartInfo:a})}},{key:"handlePartLeave",value:function(){var e=this.state.enterPartInfo;e.visible=!1,this.setState({enterPartInfo:e})}},{key:"handleSupplierChange",value:function(e){var t=this.state.itemMap;t.clear(),this.setState({supplierId:e,itemMap:t})}},{key:"handleShowPartsInfo",value:function(e){this.setState({partsInfo:e})}},{key:"handlePartAdd",value:function(e){var t=this.state.itemMap;e.map(function(e){t.set(e.purchase_item_id,e)}),this.setState({itemMap:t})}},{key:"handlePartDelete",value:function(e){var a=this.state,r=a.delItemIdSet,n=a.itemMap;n.forEach(function(a){a.purchase_item_id===e&&("0"!==t.String(a._id)&&r.add(a._id),n.delete(e))}),this.setState({delItemIdSet:r,itemMap:n})}},{key:"handlePageChange",value:function(e){var t=this.state,a=t.id,r=t.total;this.setState({page:e}),r&&this.getRejectItems(a,e)}},{key:"handleSubmit",value:function(){var e=this,a=this.state,r=a.id,n=a.isNew,l=a.itemMap,i=a.oldItemIdSet,u=a.delItemIdSet,o=this.props.form.getFieldsValue(),s=[];return t.Array.from(l.values()).forEach(function(e){s.push({_id:e._id,purchase_id:e.purchase_id,purchase_item_id:e.purchase_item_id,part_id:e.part_id,amount:e.reject_count,reject_price:e.reject_price})}),o.part_list=t.JSON.stringify(s),o.supplier_id?0===s.length?void p.default.warning("请添加配件"):(n||(o.reject_id=r,o.delete_item_ids=this.assembleDelInfo(i,u)),void C.default.ajax({type:"post",url:n?C.default.warehouse.reject.add():C.default.warehouse.reject.edit(),data:o},function(t){p.default.success("退货单保存成功"),e.setState({detail:t.res.detail})})):void p.default.warning("请选择供应商")}},{key:"getRejectDetail",value:function(e){var t=this;C.default.ajax({url:C.default.warehouse.reject.detail(e)},function(e){var a=e.res.detail;t.setState({detail:a,supplierId:a.supplier_id,supplier_name:a.supplier_name})})}},{key:"getRejectItems",value:function(e,a){var r=this;C.default.ajax({url:C.default.warehouse.reject.items(e,a)},function(e){var a=e.res,n=a.list,l=a.total,i=new t.Set,u=new t.Map;n.map(function(e){i.add(e._id),e.reject_count=e.amount,u.set(e.purchase_item_id,e)}),r.setState({oldItemIdSet:i,itemMap:u,total:t.parseInt(l,10)})})}},{key:"getSuppliers",value:function(){var e=this;C.default.ajax({url:C.default.warehouse.supplier.getAll()},function(t){e.setState({suppliers:t.res.list})})}},{key:"assembleDelInfo",value:function(e,t){var a=[];return e.forEach(function(e){t.has(e)&&a.push(e)}),a.toString()}},{key:"render",value:function(){var e=S.default.formItemThree,a=S.default.selectStyle,r=this.props.form.getFieldDecorator,n=this.state,i=n.enterPartInfo,o=n.isNew,c=this.state,f=c.page,p=c.total,h=c.itemMap,y=c.detail,v=c.suppliers,E=c.supplierId,w=t.Array.from(h.values()),R=0,C=0,j=0,I=0;w.map(function(e){R+=t.Number(e.reject_count),C+=t.Number(e.reject_count)*t.Number(e.purchase_price),j+=t.Number(e.reject_count*e.reject_price),I+=(t.parseFloat(e.purchase_price)-t.parseFloat(e.reject_price))*t.parseInt(e.reject_count,10)}),w.length>0&&w.push({_id:"合计",reject_count:R,purchase_amount_price:C.toFixed(2),reject_amount:j.toFixed(2),diff_worth:I.toFixed(2)});var x=function(e,a,r){var n={children:e,props:{}};return t.Number(r)===t.Number(w.length-1)&&(n.props.colSpan=0),n},A=this,M=[{title:"序号",dataIndex:"purchase_item_id",key:"index",width:"48px",render:function(e,a,r){return t.Number(r)===t.Number(w.length-1)?{children:"合计",props:{colSpan:6}}:r+1}},{title:"配件名",dataIndex:"part_name",key:"part_name",render:function(e,a,r){return t.Number(r)===t.Number(w.length-1)?{children:e,props:{colSpan:0}}:k.default.createElement(P.Link,{to:{pathname:"/warehouse/part/detail/"+a._id},onMouseEnter:function(e){return A.handlePartEnter(e,a)},onMouseLeave:function(e){return A.handlePartLeave(e,a)}},e)}},{title:"配件号",dataIndex:"part_no",key:"part_no",width:"120px",render:x},{title:"规格",key:"spec",width:"75px",render:function(e,a,r){return t.Number(r)===t.Number(w.length-1)?{children:"value",props:{colSpan:0}}:""+(a.spec||"")+(a.unit||"")}},{title:"品牌",dataIndex:"brand",key:"brand",width:"75px",render:function(e,a,r){var n={children:e&&e.length<=4?e:k.default.createElement(d.default,{placement:"topLeft",title:e},e),props:{}};return t.Number(r)===t.Number(w.length-1)&&(n.props.colSpan=0),n}},{title:"适用车型",dataIndex:"scope",key:"scope",width:"135px",render:function(e,a,r){var n={children:e&&e.length<=8?e:k.default.createElement(d.default,{placement:"topLeft",title:e},e),props:{}};return t.Number(r)===t.Number(w.length-1)&&(n.props.colSpan=0),n}},{title:"退货数量",dataIndex:"reject_count",key:"reject_count",width:"75px"},{title:"采购单价",dataIndex:"purchase_price",key:"purchase_price",className:"text-right",width:"80px",render:function(e,a,r){return t.Number(r)===t.Number(w.length-1)?{children:e,props:{colSpan:1}}:t.Number(e).toFixed(2)}},{title:"采购总价",dataIndex:"purchase_amount_price",className:"text-right",width:"85px",render:function(e,a,r){return t.Number(r)===t.Number(w.length-1)?{children:"￥"+e,props:{colSpan:1}}:(t.Number(a.reject_count)*t.Number(a.purchase_price)).toFixed(2)}},{title:"退货单价",dataIndex:"reject_price",key:"reject_price",className:"text-right",width:"85px",render:function(e,a,r){return t.Number(r)===t.Number(w.length-1)?{children:"",props:{colSpan:1}}:t.Number(e).toFixed(2)}},{title:"退货金额",dataIndex:"reject_amount",key:"reject_amount",className:"text-right",width:"85px",render:function(e,a,r){return t.Number(r)===t.Number(w.length-1)?{children:"￥"+e,props:{colSpan:1}}:t.Number(a.reject_count*a.reject_price).toFixed(2)}},{title:"退货差价",dataIndex:"diff_worth",key:"diff_worth",className:"text-right",width:"80px",render:function(e,a,r){var n=t.parseFloat(a.purchase_price)-t.parseFloat(a.reject_price),l=t.parseInt(a.reject_count,10);return t.Number(r)===t.Number(w.length-1)?{children:"￥"+e,props:{colSpan:1}}:t.Number(n*l).toFixed(2)}},{title:"操作",dataIndex:"purchase_item_id",key:"action",className:"center",width:"70px",fixed:"right",render:function(e,a,r){return t.Number(r)===t.Number(w.length-1)?{children:e,props:{colSpan:1}}:k.default.createElement("a",{href:"javascript:",onClick:A.handlePartDelete.bind(A,e)},"删除")}}];return k.default.createElement("div",null,k.default.createElement(G.default,{partInfo:i}),k.default.createElement(u.default,{className:"mb15"},k.default.createElement(s.default,{span:18},k.default.createElement("h4",{className:"mb10"},"基本信息"),k.default.createElement(_.default,null,k.default.createElement(u.default,null,k.default.createElement(s.default,{span:7},k.default.createElement(L,g({label:"供应商"},e),r("supplier_id",{initialValue:y.supplier_id,onChange:this.handleSupplierChange,rules:N.default.getRuleNotNull(),validateTrigger:"onChange"})(k.default.createElement(b.default,g({showSearch:!0,optionFilterProp:"children"},a,{disabled:!o,placeholder:"选择供应商"}),v.map(function(e){return k.default.createElement(V,{key:e._id},e.supplier_company)}))))),k.default.createElement(s.default,{span:7},k.default.createElement(L,g({label:"运费"},e),r("freight",{initialValue:y.freight})(k.default.createElement(m.default,{addonAfter:"元",placeholder:"输入运费"})))),k.default.createElement(s.default,{span:7},k.default.createElement(L,g({label:"物流公司"},e),r("logistics",{initialValue:y.logistics})(k.default.createElement(m.default,{placeholder:"输入物流公司"}))))),k.default.createElement(u.default,null,k.default.createElement(s.default,{span:14},k.default.createElement(L,{label:"备注",labelCol:{span:4},wrapperCol:{span:20}},r("remark",{initialValue:y.remark})(k.default.createElement(J,{placeholder:"输入备注",rows:"1"}))))))),k.default.createElement(s.default,{span:6},k.default.createElement("div",{className:"pull-right"},k.default.createElement("span",{className:"mr5"},k.default.createElement(q.default,{id:y._id,detail:y,disabled:0===t.Object.keys(y).length||"1"!==t.String(y.status)||"2"===t.String(y.pay_status)})),k.default.createElement("span",{className:"mr5"},k.default.createElement(z.default,{id:y._id,disabled:0===t.Object.keys(y).length||"2"===t.String(y.status)})),k.default.createElement(l.default,{type:"primary",onClick:this.handleSubmit,disabled:0===w.length},"保存")))),k.default.createElement("div",{className:"mb10 clearfix"},k.default.createElement("div",{className:"pull-left"},k.default.createElement("h4",{style:{lineHeight:"28px"}},"配件信息")),k.default.createElement("div",{className:"pull-right"},k.default.createElement(O.default,{supplierId:E,onAdd:this.handlePartAdd,showPartsInfo:this.handleShowPartsInfo}))),k.default.createElement("span",{className:"purchase-reject"},k.default.createElement(D.default,{columns:M,dataSource:w,total:0===p?w.length:p,currentPage:f,onPageChange:this.handlePageChange,rowKey:function(e){return e.purchase_item_id},scroll:{x:1200}})))}}]),New}(k.default.Component);Z=_.default.create()(Z),a.default=Z},v=e,_=v.webpackJsonp;if(v.webpackJsonp!==_)throw new Error("Prepack model invariant violation: "+v.webpackJsonp);var g=[16],E={1596:a,1597:r,1615:n,1673:l,1694:i,1696:u,1745:o,1756:s,1757:c,1759:d,1763:f,1786:p,1826:h,2348:m,2349:y,334:b};_(g,E)}).call(this);