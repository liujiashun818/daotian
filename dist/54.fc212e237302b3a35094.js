(function(){"use strict";var e=this,t=this,a=function(e,a,l){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(l(49),l(48)),r=_interopRequireDefault(n),i=(l(51),l(50)),u=_interopRequireDefault(i),o=function(){function defineProperties(e,a){for(var l=0;l<a.length;l++){var n=a[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),c=l(0),s=_interopRequireDefault(c),d=l(22),f=_interopRequireDefault(d),p=l(315),m=_interopRequireDefault(p),_=l(2134),h=_interopRequireDefault(_),y=l(2136),b=_interopRequireDefault(y),v=function(e){function List(e){_classCallCheck(this,List);var a=_possibleConstructorReturn(this,(List.__proto__||t.Object.getPrototypeOf(List)).call(this,e));return a.state={page:1},a}return _inherits(List,e),o(List,[{key:"render",value:function(){return s.default.createElement("div",null,s.default.createElement(r.default,{className:"head-action-bar"},s.default.createElement(u.default,{span:24},s.default.createElement("div",{className:"pull-right"},s.default.createElement(h.default,{onSuccess:this.handleSuccess})))),s.default.createElement(b.default,{source:f.default.company.list(this.state.page),page:this.state.page,reload:this.state.reload,updateState:this.updateState,onSuccess:this.handleSuccess}))}}]),List}(m.default);a.default=v},l=function(e,a,l){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(l(312),l(311)),r=_interopRequireDefault(n),i=(l(157),l(35)),u=_interopRequireDefault(i),o=function(){function defineProperties(e,a){for(var l=0;l<a.length;l++){var n=a[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),c=l(0),s=_interopRequireDefault(c),d=l(313),f=_interopRequireDefault(d),p=l(2133),m=_interopRequireDefault(p),_=function(e){function Edit(e){_classCallCheck(this,Edit);var a=_possibleConstructorReturn(this,(Edit.__proto__||t.Object.getPrototypeOf(Edit)).call(this,e));return a.state={visible:!1},a}return _inherits(Edit,e),o(Edit,[{key:"render",value:function(){return s.default.createElement("span",null,s.default.createElement("a",{href:"javascript:",onClick:this.showModal},"编辑"),s.default.createElement(r.default,{title:s.default.createElement("span",null,s.default.createElement(u.default,{type:"edit"})," 编辑门店"),visible:this.state.visible,width:"960px",onCancel:this.hideModal,footer:null},s.default.createElement(m.default,{company:this.props.company,cancelModal:this.hideModal,onSuccess:this.props.onSuccess})))}}]),Edit}(f.default);a.default=_},n=function(e,a,l){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,a,l){return a in e?t.Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(l(637),l(636)),r=_interopRequireDefault(n),i=(l(633),l(199)),u=_interopRequireDefault(i),o=(l(49),l(48)),c=_interopRequireDefault(o),s=(l(47),l(41)),d=_interopRequireDefault(s),f=(l(51),l(50)),p=_interopRequireDefault(f),m=(l(66),l(65)),_=_interopRequireDefault(m),h=(l(630),l(318)),y=_interopRequireDefault(h),b=(l(37),l(59)),v=_interopRequireDefault(b),E=(l(158),l(131)),g=_interopRequireDefault(E),k=(l(68),l(67)),P=_interopRequireDefault(k),C=t.Object.assign||function(e){for(var a=1;a<arguments.length;a++){var l=arguments[a];for(var n in l)t.Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e},R=function(){function defineProperties(e,a){for(var l=0;l<a.length;l++){var n=a[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),D=l(0),w=_interopRequireDefault(D),O=l(634),q=_interopRequireDefault(O),x=l(632),j=_interopRequireDefault(x),M=l(22),T=_interopRequireDefault(M),S=l(114),V=_interopRequireDefault(S),I=l(80),N=_interopRequireDefault(I),H=l(115),F=_interopRequireDefault(H),U=l(116),B=_interopRequireDefault(U),K=P.default.Item,L=g.default.Option,A=v.default.TextArea,z=y.default.Group,G=V.default.formItem12,J=V.default.formItemThree,W=V.default.selectStyle,Q=0,X=function(e){function EditForm(e){_classCallCheck(this,EditForm);var a=_possibleConstructorReturn(this,(EditForm.__proto__||t.Object.getPrototypeOf(EditForm)).call(this,e));return a.state={provinces:[],cities:[],countries:[],keys:[0],checkedMaintainTypeValues:[],icon_pic_key:"",icon_pic_files:[],icon_pic_progress:{},introduce_pics_0_key:"",introduce_pics_0_files:[],introduce_pics_0_progress:{}},["handleSubmit","handleProvinceChange","handleCityChange"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(EditForm,e),R(EditForm,[{key:"componentWillMount",value:function(){var e=this.props.company;this.setState({checkedMaintainTypeValues:e.maintain_types.split(",")}),this.getProvinces(),this.getCities(e.province),this.getCountries(e.province,e.city)}},{key:"componentDidMount",value:function(){var e=this.props.company;this.setState({icon_pic_key:e.icon_pic,checkedMaintainTypeValues:e.maintain_types.split(",")}),this.props.form.setFieldsValue({icon_pic:e.icon_pic}),e.icon_pic&&this.getImageUrl(T.default.system.getPublicPicUrl(e.icon_pic),"icon_pic"),e.introduce_pics&&this.getIntroducePics(e.introduce_pics)}},{key:"onMaintainTypesChange",value:function(e){this.setState({checkedMaintainTypeValues:e})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFieldsAndScroll(function(e,a){if(e)return void _.default.error(N.default.text.hasError);a.introduce_pics=t.assembleIntroducePics(a),a.maintain_types=t.state.checkedMaintainTypeValues.join(","),a.service_start_time=F.default.time(a.service_start_time,"HH:mm")||a.service_start_time,a.service_end_time=F.default.time(a.service_end_time,"HH:mm")||a.service_end_time,T.default.ajax({url:T.default.company.edit(),type:"POST",data:a},function(){_.default.success("编辑成功"),t.props.onSuccess(),t.props.cancelModal()})})}},{key:"assembleIntroducePics",value:function(e){for(var t=[],a=e.keys,l=0;l<a.length;l++){var n="introduce_pics_hide_"+l,r="introduce_pics_"+l+"_key";this.state[n]||t.push(this.state[r])}return delete e.keys,t.join(",")}},{key:"handleProvinceChange",value:function(e){this.getCities(e)}},{key:"handleCityChange",value:function(e){this.getCountries(this.state.province,e)}},{key:"getProvinces",value:function(){var e=this;T.default.ajax({url:T.default.system.getProvinces()},function(t){e.setState({provinces:t.res.province_list})})}},{key:"getCities",value:function(e){var t=this;T.default.ajax({url:T.default.system.getCities(e)},function(a){t.setState({province:e,cities:a.res.city_list})})}},{key:"getCountries",value:function(e,t){var a=this;T.default.ajax({url:T.default.system.getCountries(e,t)},function(e){a.setState({countries:e.res.country_list})})}},{key:"getIntroducePics",value:function(e){for(var t=this,a=[],l={},n=e.split(",");n.indexOf("")>=0;)n.splice(n.indexOf(""),1);n.length>0&&(Q=n.length-1,n.map(function(e,n){a.push(n);var r="introduce_pics_"+n,i="introduce_pics_"+n+"_key",u="introduce_pics_"+n+"_files",o="introduce_pics_"+n+"_progress";l[i]=e,l[u]=[],l[o]={},t.setState(l),t.getImageUrl(T.default.system.getPublicPicUrl(e),r)})),this.setState({keys:a})}},{key:"addIntroducePics",value:function(){var e;Q++;var t=this.props.form,a=t.getFieldValue("keys");a=a.concat(Q),t.setFieldsValue({keys:a});var l="introduce_pics_"+Q+"_key",n="introduce_pics_"+Q+"_files",r="introduce_pics_"+Q+"_progress";this.setState((e={},_defineProperty(e,l,""),_defineProperty(e,n,[]),_defineProperty(e,r,{}),e))}},{key:"disabledMinutes",value:function(){for(var e=[],t=0;t<60;t++)e.push(t);return e.filter(function(e){return e%5!=0})}},{key:"removeIntroducePics",value:function(e){var t="introduce_pics_hide_"+e;this.setState(_defineProperty({},t,!0))}},{key:"render",value:function(){var e=this,a=this.props.form,l=a.getFieldDecorator,n=a.getFieldValue,i=this.props.company,o=this.state,s=o.provinces,f=o.cities,m=o.countries,_=o.keys,h={rules:[{required:!0,message:N.default.required.notNull},{validator:B.default.notNull}],validateTrigger:"onBlur"};l("keys",{initialValue:_});var b=n("keys").map(function(t){var a="introduce_pics_hide_"+t;return w.default.createElement(c.default,{className:e.state[a]?"hide":"",key:t},w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"门店介绍"},J,{help:"尺寸: 1080*1800px"}),w.default.createElement(j.default,{prefix:"introduce_pics_"+t,saveKey:e.handleKey.bind(e),source:T.default.system.getPublicPicUploadToken("introduce_pics"),onDrop:e.onDrop.bind(e,"introduce_pics_"+t),onUpload:e.onUpload.bind(e,"introduce_pics_"+t)},e.renderImage("introduce_pics_"+t)))),w.default.createElement(p.default,{span:8},0===t?w.default.createElement("div",null,w.default.createElement(d.default,{size:"small",type:"primary",icon:"plus",onClick:function(){return e.addIntroducePics(t)}},"添加")):w.default.createElement(d.default,{size:"small",type:"ghost",icon:"minus",onClick:function(){return e.removeIntroducePics(t)}},"删除")))}),E=u.default.Group,k=[{label:"新车销售",value:"6"},{label:"保养",value:"2"},{label:"维修",value:"3"},{label:"钣金",value:"4"},{label:"喷漆",value:"5"},{label:"洗车",value:"7"},{label:"美容",value:"1"}];return w.default.createElement(P.default,null,l("company_id",{initialValue:i._id})(w.default.createElement(v.default,{type:"hidden"})),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:16},w.default.createElement(K,C({label:"门店名称"},G),l("company_name",C({initialValue:i.name},h))(w.default.createElement(v.default,{placeholder:"请输入门店名称"}))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"省份"},J),l("province",C({initialValue:i.province},h))(w.default.createElement(g.default,C({onSelect:this.handleProvinceChange,placeholder:"请选择省份"},W,{disabled:!0}),s.map(function(e){return w.default.createElement(L,{key:e.name},e.name)}))))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"城市"},J),l("city",C({initialValue:i.city},h))(w.default.createElement(g.default,C({onSelect:this.handleCityChange,placeholder:"请选择城市"},W,{disabled:!0}),f.map(function(e){return w.default.createElement(L,{key:e.name},e.name)}))))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"区县"},J),l("country",C({initialValue:i.country},h))(w.default.createElement(g.default,C({},W,{placeholder:"请选择区县",disabled:!0}),m.map(function(e){return w.default.createElement(L,{key:e.name},e.name)})))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:16},w.default.createElement(K,C({label:"门店地址"},G),l("address",C({initialValue:i.address},h))(w.default.createElement(v.default,{placeholder:"请输入门店地址"}))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:16},w.default.createElement(K,C({label:"产值类型"},G,{required:!0}),w.default.createElement(E,{className:"mb10",options:k,defaultValue:this.state.checkedMaintainTypeValues,onChange:this.onMaintainTypesChange.bind(this)})))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"店总负责人"},J),l("admin_name",C({initialValue:i.admin_name},h))(w.default.createElement(v.default,{placeholder:"请输入店总负责人"})))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"负责人电话"},J),l("admin_phone",{initialValue:i.admin_phone,rules:B.default.getRulePhoneNumber(),validateTrigger:"onBlur"})(w.default.createElement(v.default,{placeholder:"请输入负责人电话"}))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"其他联系人"},J),l("other_name",{initialValue:i.other_name})(w.default.createElement(v.default,{placeholder:"请输入其他联系人"})))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"联系人电话"},J),l("other_phone",{initialValue:i.other_phone,rules:B.default.getRulePhoneNumber(!1),validateTrigger:"onBlur"})(w.default.createElement(v.default,{placeholder:"请输入联系人电话"}))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"服务电话"},J),l("service_phone",{initialValue:i.service_phone,rules:B.default.getRulePhoneOrTelNumber(),validateTrigger:"onBlur"})(w.default.createElement(v.default,{placeholder:"请输入服务电话"})))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"营业时间"},J),l("service_start_time",{initialValue:i.service_start_time?F.default.getMomentHHmm(i.service_start_time):F.default.getMomentHHmm("07:30")})(w.default.createElement(r.default,{disabledMinutes:this.disabledMinutes.bind(this),hideDisabledOptions:!0,format:F.default.pattern.HHmm})),"-",l("service_end_time",{initialValue:i.service_end_time?F.default.getMomentHHmm(i.service_end_time):F.default.getMomentHHmm("17:30")})(w.default.createElement(r.default,{disabledMinutes:this.disabledMinutes.bind(this),hideDisabledOptions:!0,format:F.default.pattern.HHmm})))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"在App展示"},J),l("is_show_on_app",{initialValue:t.Number(i.is_show_on_app)})(w.default.createElement(z,null,w.default.createElement(y.default,{value:0},"否"),w.default.createElement(y.default,{value:1},"是")))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:16},w.default.createElement(K,C({label:"门店照片"},G,{help:"尺寸: 330*240px"}),l("icon_pic")(w.default.createElement(v.default,{type:"hidden"})),w.default.createElement(j.default,{prefix:"icon_pic",saveKey:this.handleKey.bind(this),source:T.default.system.getPublicPicUploadToken("icon_pic"),onDrop:this.onDrop.bind(this,"icon_pic"),onUpload:this.onUpload.bind(this,"icon_pic")},this.renderImage("icon_pic"))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:16},w.default.createElement(K,C({label:"开户银行"},G),l("bank_name",{initialValue:i.bank_name})(w.default.createElement(v.default,{placeholder:"请输入门店开户银行及支行信息"}))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"银行卡户主"},J),l("bank_account_name",{initialValue:i.bank_account_name})(w.default.createElement(v.default,{placeholder:"请输入银行卡户主"})))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"银行卡卡号"},J),l("bank_account_number",{initialValue:i.bank_account_number})(w.default.createElement(v.default,{placeholder:"请输入银行卡卡号"}))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:16},w.default.createElement(K,C({label:"备注"},G),l("remark",{initialValue:i.remark})(w.default.createElement(A,{placeholder:"备注"}))))),b,w.default.createElement(K,{className:"center mt30 mb15"},w.default.createElement(d.default,{type:"ghost",className:"mr15",onClick:this.props.cancelModal},"取消"),w.default.createElement(d.default,{type:"primary",onClick:this.handleSubmit},"提交")))}}]),EditForm}(q.default);X=P.default.create()(X),a.default=X},r=function(e,a,l){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(l(312),l(311)),r=_interopRequireDefault(n),i=(l(157),l(35)),u=_interopRequireDefault(i),o=(l(47),l(41)),c=_interopRequireDefault(o),s=function(){function defineProperties(e,a){for(var l=0;l<a.length;l++){var n=a[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),d=l(0),f=_interopRequireDefault(d),p=l(313),m=_interopRequireDefault(p),_=l(2135),h=_interopRequireDefault(_),y=function(e){function New(e){_classCallCheck(this,New);var a=_possibleConstructorReturn(this,(New.__proto__||t.Object.getPrototypeOf(New)).call(this,e));return a.state={visible:!1},a}return _inherits(New,e),s(New,[{key:"render",value:function(){return f.default.createElement("span",null,f.default.createElement(c.default,{type:"primary",onClick:this.showModal},"创建门店"),f.default.createElement(r.default,{title:f.default.createElement("span",null,f.default.createElement(u.default,{type:"plus"})," 创建门店"),visible:this.state.visible,width:"960px",onCancel:this.hideModal,footer:null},f.default.createElement(h.default,{cancelModal:this.hideModal,onSuccess:this.props.onSuccess})))}}]),New}(m.default);a.default=y},i=function(e,a,l){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,a,l){return a in e?t.Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=(l(637),l(636)),r=_interopRequireDefault(n),i=(l(633),l(199)),u=_interopRequireDefault(i),o=(l(49),l(48)),c=_interopRequireDefault(o),s=(l(47),l(41)),d=_interopRequireDefault(s),f=(l(51),l(50)),p=_interopRequireDefault(f),m=(l(66),l(65)),_=_interopRequireDefault(m),h=(l(37),l(59)),y=_interopRequireDefault(h),b=(l(630),l(318)),v=_interopRequireDefault(b),E=(l(158),l(131)),g=_interopRequireDefault(E),k=(l(68),l(67)),P=_interopRequireDefault(k),C=t.Object.assign||function(e){for(var a=1;a<arguments.length;a++){var l=arguments[a];for(var n in l)t.Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e},R=function(){function defineProperties(e,a){for(var l=0;l<a.length;l++){var n=a[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),D=l(0),w=_interopRequireDefault(D),O=l(634),q=_interopRequireDefault(O),x=l(114),j=_interopRequireDefault(x),M=l(22),T=_interopRequireDefault(M),S=l(632),V=_interopRequireDefault(S),I=l(80),N=_interopRequireDefault(I),H=l(115),F=_interopRequireDefault(H),U=l(116),B=_interopRequireDefault(U),K=P.default.Item,L=g.default.Option,A=v.default.Group,z=y.default.TextArea,G=j.default.formItem12,J=j.default.formItemThree,W=j.default.selectStyle,Q=0,X=function(e){function NewForm(e){_classCallCheck(this,NewForm);var a=_possibleConstructorReturn(this,(NewForm.__proto__||t.Object.getPrototypeOf(NewForm)).call(this,e));return a.state={provinces:[],cities:[],countries:[],keys:[0],checkedMaintainTypeValues:[],icon_pic_key:"",icon_pic_files:[],icon_pic_progress:{},introduce_pics_0_key:"",introduce_pics_0_files:[],introduce_pics_0_progress:{}},["handleSubmit","handleProvinceChange","handleCityChange"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(NewForm,e),R(NewForm,[{key:"componentWillMount",value:function(){this.getProvinces()}},{key:"onMaintainTypesChange",value:function(e){this.setState({checkedMaintainTypeValues:e})}},{key:"handleProvinceChange",value:function(e){this.getCities(e)}},{key:"handleCityChange",value:function(e){this.getCountries(this.state.province,e)}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFieldsAndScroll(function(e,a){if(e)return void _.default.error(N.default.text.hasError);a.introduce_pics=t.assembleIntroducePics(a),a.maintain_types=t.state.checkedMaintainTypeValues.join(","),a.service_start_time=F.default.time(a.service_start_time,"HH:mm"),a.service_end_time=F.default.time(a.service_end_time,"HH:mm"),T.default.ajax({url:T.default.company.add(),type:"POST",data:a},function(){_.default.success("添加成功"),t.props.onSuccess(),t.props.cancelModal()})})}},{key:"getProvinces",value:function(){var e=this;T.default.ajax({url:T.default.system.getProvinces()},function(t){e.setState({provinces:t.res.province_list})})}},{key:"getCities",value:function(e){var t=this;T.default.ajax({url:T.default.system.getCities(e)},function(a){t.setState({province:e,cities:a.res.city_list})})}},{key:"getCountries",value:function(e,t){var a=this;T.default.ajax({url:T.default.system.getCountries(e,t)},function(e){a.setState({countries:e.res.country_list})})}},{key:"assembleIntroducePics",value:function(e){for(var t=[],a=e.keys,l=0;l<a.length;l++){var n="introduce_pics_hide_"+l,r="introduce_pics_"+l+"_key";this.state[n]||t.push(this.state[r])}return delete e.keys,t.join(",")}},{key:"disabledMinutes",value:function(){for(var e=[],t=0;t<60;t++)e.push(t);return e.filter(function(e){return e%5!=0})}},{key:"addIntroducePics",value:function(){var e;Q++;var t=this.props.form,a=t.getFieldValue("keys");a=a.concat(Q),t.setFieldsValue({keys:a});var l="introduce_pics_"+Q+"_key",n="introduce_pics_"+Q+"_files",r="introduce_pics_"+Q+"_progress";this.setState((e={},_defineProperty(e,l,""),_defineProperty(e,n,[]),_defineProperty(e,r,{}),e))}},{key:"removeIntroducePics",value:function(e){var t="introduce_pics_hide_"+e;this.setState(_defineProperty({},t,!0))}},{key:"render",value:function(){var e=this,t=this.props.form,a=t.getFieldDecorator,l=t.getFieldValue,n=this.state,i=n.provinces,o=n.cities,s=n.countries,f=n.keys,m={rules:[{required:!0,message:N.default.required.notNull},{validator:B.default.notNull}],validateTrigger:"onBlur"};a("keys",{initialValue:f});var _=l("keys").map(function(t){var a="introduce_pics_hide_"+t;return w.default.createElement(c.default,{className:e.state[a]?"hide":"",key:t},w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"门店介绍"},J,{help:"尺寸: 1080*1800px"}),w.default.createElement(V.default,{prefix:"introduce_pics_"+t,saveKey:e.handleKey.bind(e),source:T.default.system.getPublicPicUploadToken("introduce_pics"),onDrop:e.onDrop.bind(e,"introduce_pics_"+t),onUpload:e.onUpload.bind(e,"introduce_pics_"+t)},e.renderImage("introduce_pics_"+t)))),w.default.createElement(p.default,{span:8},0===t?w.default.createElement("div",null,w.default.createElement(d.default,{size:"small",type:"primary",icon:"plus",onClick:function(){return e.addIntroducePics(t)}},"添加")):w.default.createElement(d.default,{size:"small",type:"ghost",icon:"minus",onClick:function(){return e.removeIntroducePics(t)}},"删除")))}),h=u.default.Group,b=[{label:"新车销售",value:"6"},{label:"保养",value:"2"},{label:"维修",value:"3"},{label:"钣金",value:"4"},{label:"喷漆",value:"5"},{label:"洗车",value:"7"},{label:"美容",value:"1"}];return w.default.createElement(P.default,null,w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:16},w.default.createElement(K,C({label:"门店名称"},G),a("company_name",C({},m))(w.default.createElement(y.default,{placeholder:"请输入门店名称"}))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"省份"},J),a("province",C({},m))(w.default.createElement(g.default,C({onSelect:this.handleProvinceChange,placeholder:"请选择省份"},W),i.map(function(e){return w.default.createElement(L,{key:e.name},e.name)}))))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"城市"},J),a("city",C({},m))(w.default.createElement(g.default,C({onSelect:this.handleCityChange,placeholder:"请选择城市"},W),o.map(function(e){return w.default.createElement(L,{key:e.name},e.name)}))))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"区县"},J),a("country",C({},m))(w.default.createElement(g.default,C({},W,{placeholder:"请选择区县"}),s.map(function(e){return w.default.createElement(L,{key:e.name},e.name)})))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:16},w.default.createElement(K,C({label:"门店地址"},G),a("address",C({},m))(w.default.createElement(y.default,{placeholder:"请输入门店地址"}))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:16},w.default.createElement(K,C({label:"产值类型"},G,{required:!0}),w.default.createElement(h,{className:"mb10",options:b,defaultValue:this.state.checkedMaintainTypeValues,onChange:this.onMaintainTypesChange.bind(this)})))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"店总负责人"},J),a("admin_name",C({},m))(w.default.createElement(y.default,{placeholder:"请输入店总负责人"})))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"负责人电话"},J),a("admin_phone",{rules:B.default.getRulePhoneNumber(),validateTrigger:"onBlur"})(w.default.createElement(y.default,{placeholder:"请输入负责人电话"}))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"其他联系人"},J),a("other_name")(w.default.createElement(y.default,{placeholder:"请输入其他联系人"})))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"联系人电话"},J),a("other_phone",{rules:B.default.getRulePhoneNumber(!1),validateTrigger:"onBlur"})(w.default.createElement(y.default,{placeholder:"请输入联系人电话"}))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"服务电话"},J),a("service_phone",{rules:B.default.getRulePhoneOrTelNumber(),validateTrigger:"onBlur"})(w.default.createElement(y.default,{placeholder:"请输入服务电话"})))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"营业时间"},J),a("service_start_time",{initialValue:F.default.getMomentHHmm("07:30")})(w.default.createElement(r.default,{disabledMinutes:this.disabledMinutes.bind(this),hideDisabledOptions:!0,format:"HH:mm"})),"-",a("service_end_time",{initialValue:F.default.getMomentHHmm("17:30")})(w.default.createElement(r.default,{disabledMinutes:this.disabledMinutes.bind(this),hideDisabledOptions:!0,format:"HH:mm"})))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"在App展示"},J),a("is_show_on_app",{initialValue:0})(w.default.createElement(A,null,w.default.createElement(v.default,{value:0},"否"),w.default.createElement(v.default,{value:1},"是")))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:16},w.default.createElement(K,C({label:"门店照片"},G,{help:"尺寸: 330*240px"}),a("icon_pic")(w.default.createElement(y.default,{type:"hidden"})),w.default.createElement(V.default,{prefix:"icon_pic",saveKey:this.handleKey.bind(this),source:T.default.system.getPublicPicUploadToken("icon_pic"),onDrop:this.onDrop.bind(this,"icon_pic"),onUpload:this.onUpload.bind(this,"icon_pic")},this.renderImage("icon_pic"))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:16},w.default.createElement(K,C({label:"开户银行"},G),a("bank_name")(w.default.createElement(y.default,{placeholder:"请输入门店开户银行及支行信息"}))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"银行卡户主"},J),a("bank_account_name")(w.default.createElement(y.default,{placeholder:"请输入银行卡户主"})))),w.default.createElement(p.default,{span:8},w.default.createElement(K,C({label:"银行卡卡号"},J),a("bank_account_number")(w.default.createElement(y.default,{placeholder:"请输入银行卡卡号"}))))),w.default.createElement(c.default,{type:"flex"},w.default.createElement(p.default,{span:16},w.default.createElement(K,C({label:"备注"},G),a("remark")(w.default.createElement(z,{placeholder:"备注"}))))),_,w.default.createElement(K,{className:"center mt30 mb15"},w.default.createElement(d.default,{type:"ghost",className:"mr15",onClick:this.props.cancelModal},"取消"),w.default.createElement(d.default,{type:"primary",onClick:this.handleSubmit},"创建")))}}]),NewForm}(q.default);X=P.default.create()(X),a.default=X},u=function(e,a,l){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var n=function(){function defineProperties(e,a){for(var l=0;l<a.length;l++){var n=a[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),t.Object.defineProperty(e,n.key,n)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),r=l(0),i=_interopRequireDefault(r),u=l(316),o=_interopRequireDefault(u),c=l(2132),s=_interopRequireDefault(c),d=l(331),f=_interopRequireDefault(d),p=function(e){function Table(){return _classCallCheck(this,Table),_possibleConstructorReturn(this,(Table.__proto__||t.Object.getPrototypeOf(Table)).apply(this,arguments))}return _inherits(Table,e),n(Table,[{key:"render",value:function(){var e=this,t=[{title:"门店编号",dataIndex:"company_num",key:"company_num"},{title:"门店名称",dataIndex:"name",key:"name"},{title:"省份",dataIndex:"province",key:"province"},{title:"城市",dataIndex:"city",key:"city"},{title:"区县",dataIndex:"country",key:"country"},{title:"详细地址",dataIndex:"address",key:"address"},{title:"店总负责人",dataIndex:"admin_name",key:"admin_name"},{title:"负责人电话",dataIndex:"admin_phone",key:"admin_phone"},{title:"其他联系人",dataIndex:"other_name",key:"other_name"},{title:"联系电话",dataIndex:"other_phone",key:"other_phone"},{title:"服务电话",dataIndex:"service_phone",key:"service_phone"},{title:"操作",dataIndex:"action",key:"action",className:"center",render:function(t,a){return i.default.createElement("span",null,i.default.createElement(s.default,{company:a,onSuccess:e.props.onSuccess}),i.default.createElement("span",{className:"ant-divider"}),i.default.createElement(f.default,{company:a}))}}];return this.renderTable(t)}}]),Table}(o.default);a.default=p},o=e,c=o.webpackJsonp;if(o.webpackJsonp!==c)throw new Error("Prepack model invariant violation: "+o.webpackJsonp);var s=[54],d={1515:a,2132:l,2133:n,2134:r,2135:i,2136:u};c(s,d)}).call(this);