(function(){var e=this,t=this,a=function(e,a,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var r=(n(49),n(48)),i=_interopRequireDefault(r),l=(n(51),n(50)),o=_interopRequireDefault(l),u=(n(47),n(41)),s=_interopRequireDefault(u),c=(n(37),n(59)),d=_interopRequireDefault(c),f=(n(629),n(314)),p=_interopRequireDefault(f),h=(n(66),n(65)),m=_interopRequireDefault(h),y=function(){function defineProperties(e,a){for(var n=0;n<a.length;n++){var r=a[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),t.Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),v=n(0),k=_interopRequireDefault(v),b=n(22),g=_interopRequireDefault(b),w=n(198),P=_interopRequireDefault(w),_=n(1786),E=_interopRequireDefault(_),S=n(1967),C=_interopRequireDefault(S),R=n(1966),D=_interopRequireDefault(R),x=n(1850),I=_interopRequireDefault(x),N=n(1968),j=_interopRequireDefault(N),A=function(e){function New(e){_classCallCheck(this,New);var a=_possibleConstructorReturn(this,(New.__proto__||t.Object.getPrototypeOf(New)).call(this,e));return a.state={isFetching:!1,parts:[],partsAll:[],page:1,total:0,chooseParts:""},["handlePageChange","handleSaveNewParts","handleComplete","handTableRowClick","handleShowPartsInfo"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(New,e),y(New,[{key:"componentDidMount",value:function(){this.createStocktaking(),this.setInputContentPadding()}},{key:"componentDidUpdate",value:function(){this.setInputContentPadding()}},{key:"setInputContentPadding",value:function(){var e=t.document.getElementsByClassName("input-content");if(e=t.Array.from(e))for(var a in e)e.hasOwnProperty(a)&&(e[a].parentNode.parentNode.style.padding="2px 2px")}},{key:"createStocktaking",value:function(){var e=this;g.default.ajax({url:g.default.warehouse.stocktaking.new()},function(t){var a=t.res.detail;e.setState({id:a._id}),e.getStockTakingParts(a._id,e.state.page),e.getAllStockTakingParts(a._id)},function(e){m.default.error("开单失败["+e+"]")})}},{key:"handleShowPartsInfo",value:function(e){this.setState({partsInfo:e,chooseParts:""})}},{key:"handTableRowClick",value:function(e){this.setState({chooseParts:e})}},{key:"render",value:function(){var e=this.state,t=e.isFetching,a=e.id,n=e.parts,r=e.page,l=e.total,u=e.chooseParts,c=e.updatePermission,f=e.partsAll,h=this,m=[{title:"序号",dataIndex:"_id",key:"index",className:"center",width:"48px",render:function(e,t,a){return(r-1)*g.default.config.limit+(a+1)}},{title:"配件分类",dataIndex:"auto_part.part_type_name",key:"part_type_name",width:"245px",render:function(e){return e?e.length<=12?k.default.createElement("span",null,e):k.default.createElement(p.default,{placement:"topLeft",title:e},e):""}},{title:"配件名称",dataIndex:"auto_part.name",key:"name"},{title:"配件号",dataIndex:"auto_part.part_no",key:"part_no",width:"120px"},{title:"规格",key:"spec",width:"75px",render:function(e,t){return""+t.auto_part.spec+t.auto_part.unit}},{title:"适用车型",dataIndex:"auto_part.scope",key:"scope",width:"135px",render:function(e){return e?e.length<=8?k.default.createElement("span",null,e):k.default.createElement(p.default,{placement:"topLeft",title:e},e):""}},{title:"品牌",dataIndex:"auto_part.brand",key:"brand",width:"75px",render:function(e){return e?e.length<=4?k.default.createElement("span",null,e):k.default.createElement(p.default,{placement:"topLeft",title:e},e):""}},{title:"实际数量",dataIndex:"real_amount",key:"real_amount",className:"center",width:"75px",render:function(e,t){return k.default.createElement("div",null,k.default.createElement("div",{className:"input-content"}),k.default.createElement(d.default,{defaultValue:e,style:{width:70},onBlur:h.handleInputBlur.bind(h,t._id,t.auto_part._id,a),size:"large"}))}}];return k.default.createElement("div",null,k.default.createElement(E.default,{partsInfo:this.state.partsInfo,onTableRowClick:this.handTableRowClick}),k.default.createElement(i.default,{className:"mb15"},k.default.createElement(o.default,{span:24},k.default.createElement("div",{className:"pull-right"},k.default.createElement("span",{className:"mr10"},k.default.createElement(I.default,{size:"default",id:a,updatePermission:c})),k.default.createElement("span",{className:"mr10"},k.default.createElement(j.default,{id:a})),k.default.createElement(s.default,{type:"primary",onClick:this.handleComplete},"完成")))),k.default.createElement(i.default,{className:"mb5"},k.default.createElement(o.default,{span:18},k.default.createElement("p",{className:"text-gray"},"提示：由于盘点数据过多，建议先打印盘点单，将盘点数据填写完整后,再进行系统录入，盘点单中缺失的配件，请点击“添加配件”手动录入")),k.default.createElement(o.default,{span:6},k.default.createElement("div",{className:"pull-right"},k.default.createElement(D.default,{stocktakingId:a,onSave:this.handleSaveNewParts,showPartsInfo:this.handleShowPartsInfo,chooseParts:u,partsAll:f})))),k.default.createElement("span",{className:"stocktaking-new"},k.default.createElement(P.default,{isLoading:t,tip:"正在导入库存，请稍候...",columns:m,dataSource:n,total:l,currentPage:r,onPageChange:this.handlePageChange})))}}]),New}(C.default);a.default=A},n=function(e,a,n){"use strict";t.Object.defineProperty(a,"__esModule",{value:!0});var r={aftersales:{project:{destroy:"aftersales/project/destroy"},consumptiveMaterial:{examine:"aftersales/consumptive-material/examine"}},warehouse:{purchase:{import:"warehouse/purchase/import",pay:"warehouse/purchase/pay"},purchaseReject:{export:"warehouse/purchase-reject/export",pay:"warehouse/purchase-reject/pay"},stocktaking:{auth:"warehouse/stocktaking/auth",authorize:"warehouse/stocktaking/authorize",import:"warehouse/stocktaking/import"},supplier:{pay:"warehouse/supplier/pay"}},customer:{information:"customer/customer-information",auto:"customer/auto-information",insurance:"customer/insurance-information",deal:"customer/deal-information",maintenance:"customer/maintenance-information",intention:"customer/intention-information",reminder:"customer/reminder"},deal:{calculatedReturn:"presales/deal-auto/calculation-income"},maintainItem:{commission:"maintain-item/commission"},marketing:{commission:"\tmarketing/membercard/commission"}};a.default=r},r=function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDE0IDc5LjE1Njc5NywgMjAxNC8wOC8yMC0wOTo1MzowMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTI3QzI1RUMyRTRCMTFFNzlCQjVGREFERkNEMDJCNjYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTI3QzI1RUQyRTRCMTFFNzlCQjVGREFERkNEMDJCNjYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBMjdDMjVFQTJFNEIxMUU3OUJCNUZEQURGQ0QwMkI2NiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBMjdDMjVFQjJFNEIxMUU3OUJCNUZEQURGQ0QwMkI2NiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqkGoiQAAAWqSURBVHjazJhbTBxlFMe/meW6y2K5LKES2GrRwkOrGKwo+kQbL4FXwPjQJo0NwQZeIPKojwZCAvoAiQ8QmxJ4MEKaGGPQRCQmmkBLmqApBhYWFroQkL1fx/8ZZrazy87szgLaj/7Zsjvfd357zvnOd+EEQWDPcuPZM96y6Fd9fX0mfV+A3oXehmohK2SWPnNBNmgZ+hX6AVpVG2hl6c+k7x8E3UeAOpoBaoXuQG9CnMpzJZJegz6CKI9+g76CpqCImgEOP5R2HKc/xNegR9A96C0NuOR2j/rck8a4lvQpgf4J4tOCjhzMg0ahH6GaU0irGmmsUWns+K+hc5JYoF+g22eQ/7elsS2y9/TOYuo4B71+hpOUxp6rvlJjSQx1KkAjdB+6lFaCcdxJIMnG/epXaozJQq0GOAxdTdfCKRR7sjXMKcjk//NJjF3Hy63/oSbfevHyy9fF8MqzORHQ/Y/LgHANa42Sn5/P2tvbdYfVYrGw5ubmVKnyZcXFqixlHsYValNhwYdapcRoNLKhoSFWV1fHKisr2cDAQFrhJbiRkRFWVVXFzGYzm5iYUM3HPFM+vj27eywHsdyQSz7RMtTS0iLCUWtra2M9PT0pPSnDWa1W8dnOzk7xPY12h1NMkxjghdrqagzwhlbPqakpUXJLBamEo+b3+1l3dzdzOp1aYb5qra1+6Rggz/MfpFq+KJz9/f1pQSaD6+rqYgsLCymrFljel3NQBPx76S8eBhrTLSmpIE8AJ3uxEa7iFZNEMOCNWj11jyCptba2xiCpjY+PxyZEJnBSEayRdk5RjoydyynIw3KzhTeK9JQO8lhvb28MkprH42EmkylzOGkriKie3w+6/LxUc+i1QO8oycJ9CnDiMCjU/NNJwmW+9SfIsbEx0XPKNj8/zxYXF098HOEVOwhPJqPIE0L2nNyamprSqpMqG1fvsTIDlzoygRsdHY2bELOzs2nXSXU+YSsOkLpHo9GVk8JRzvX19ekq5skaWB7HAaImRiPhyO8nhaMJoaeYqzWw/EGcyhBHfW7Pz+ob7/TgMllxkkVYYokqQxxxbu6swLUPtHqWlZWlhEuEnJyc1AUJhoe7m09W5KOpHGL6IxD0B+5qATY0NIjbrHTrHEHSlkwJSbO7uLhYtU/IH/wG/QKAegqIVYTcGXSs2qfxoeoNwMzMDBscHGQ+ny/tIqyE3N3dZR0dHWxvb0/t2dWttY1phDQIiSEWlzq6+sB+MJuWuvMXKlpMheavtYyWlpaKxvQuiyUlJZr9PIfujx1r9hkkwD56hLDUxRXqMA4qXsfa5k+RUGRay5heONmTWv3CofB3gKMi6kXKhY8Vahz7MITgp4sfuPkzJOuj/+q0RLYcNvvncJIL8lOlTnpoggcpMT1BX8D5xL7dKUQE21nDCVHB5oStgNfvBIAHiqieiy9euUTgAfw6dB8cru9sOm7i2y2foeeWd+yOm+4D1zqYDqmSJNbiY7sYhJpmDy3WB4C02VdsN8Kh0LenDUdjbjxeu0E2yJZwtEGIKg/tcbM4sWHDSLttbFGEInylgvKq59/B7P6U4znrSUPqOXR9sb2+NQdfuRnNWIQWUGEKH6dwIV1gqgJKR1GDdE9TiF5mPos3llsr3ssz5rfhYHNZzx0hwrnk9/qmtm2b30cjUa94CysgrJzouUjiJSZh7qcClCB5PJ4riN4Ur3jzoeznSouqzOcKG7Oys1/lDfwF1LlyyCSVFA+0DZA1hPIBwjh/sLu/QYsB5JPgaP8ZoJQSr4CFo68r3rCKnuQY1cGUgIpDPYU8lzyKzkYMkos3szCuAX/z0hadkwwJ4oGHcZRTEXxGNTYAW17JYzQZwljBhNgdtXA8HrEQF+UUsNgNBpf8albh+yy8ZMNojgScI8EbFL3JCRF4lPIqKAHRa4gdFWFB9X5a8REB/ivAABt+/qZv1YdyAAAAAElFTkSuQmCC"},i=function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDE0IDc5LjE1Njc5NywgMjAxNC8wOC8yMC0wOTo1MzowMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MjhFNEFDNzUyN0RDMTFFNzg5MEM5NTM3NDkyMzU4RTIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MjhFNEFDNzYyN0RDMTFFNzg5MEM5NTM3NDkyMzU4RTIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoyOEU0QUM3MzI3REMxMUU3ODkwQzk1Mzc0OTIzNThFMiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoyOEU0QUM3NDI3REMxMUU3ODkwQzk1Mzc0OTIzNThFMiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PhelemwAAAz4SURBVHja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"},l=function(e,a,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var r=(n(312),n(311)),i=_interopRequireDefault(r),l=(n(49),n(48)),o=_interopRequireDefault(l),u=(n(51),n(50)),s=_interopRequireDefault(u),c=(n(37),n(59)),d=_interopRequireDefault(c),f=(n(157),n(35)),p=_interopRequireDefault(f),h=(n(66),n(65)),m=_interopRequireDefault(h),y=function(){function defineProperties(e,a){for(var n=0;n<a.length;n++){var r=a[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),t.Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),v=n(0),k=_interopRequireDefault(v),b=n(313),g=_interopRequireDefault(b),w=n(22),P=_interopRequireDefault(w);n(1759);var _=function(e){function Type(e){_classCallCheck(this,Type);var a=_possibleConstructorReturn(this,(Type.__proto__||t.Object.getPrototypeOf(Type)).call(this,e));return a.state={superPartVisible:!1,superPartList:[],secondPartList:[],secondPartName:"",superPartListOne:[],superPartListTwo:[]},["handleSecondPartClick","handleShowSuper","handleHideSuper","handleDelete","handleCancel"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(Type,e),y(Type,[{key:"componentDidMount",value:function(){this.getSuperPartTypeList()}},{key:"componentWillReceiveProps",value:function(e){e.defaultValue&&(this.state.secondPartName||this.setState({secondPartName:e.defaultValue}))}},{key:"handleSecondPartClick",value:function(e,t){this.setState({secondPartName:t+"/"+e.name,superPartVisible:!1}),this.props.onSuccess(e._id,e,this.handleCancel,t)}},{key:"handleCancel",value:function(){this.setState({secondPartName:""})}},{key:"handleShowSuper",value:function(){this.setState({superPartVisible:!0})}},{key:"handleHideSuper",value:function(){this.setState({superPartVisible:!1})}},{key:"handleDelete",value:function(){this.setState({secondPartName:""}),this.props.onSuccess("")}},{key:"getSuperPartTypeList",value:function(){var e=this;P.default.ajax({url:P.default.warehouse.category.partAllPartTypes()},function(t){var a=t.res.list.slice(0,6),n=t.res.list.slice(6,11);e.setState({superPartListOne:a,superPartListTwo:n})},function(e){m.default.error("获取列表数据失败["+e+"]")})}},{key:"render",value:function(){var e=this,t=this.state,a=t.superPartVisible,n=t.secondPartName,r=t.superPartListOne,l=t.superPartListTwo;return k.default.createElement("span",null,k.default.createElement(d.default,{placeholder:"请选择",onClick:this.handleShowSuper,value:n,style:this.props.style,size:"large",suffix:k.default.createElement(p.default,{type:"close-circle-o",className:n?"":"hide",onClick:this.handleDelete}),ref:function(t){return e.partType=t}}),k.default.createElement(i.default,{title:"请选择配件分类",visible:a,footer:null,onCancel:this.handleHideSuper,width:720},k.default.createElement(o.default,{className:"mb20"},r.map(function(t){return k.default.createElement(s.default,{key:t._id+t.name,span:4},k.default.createElement("div",{className:"super-type"},t.name),t.sub_list.map(function(a){return k.default.createElement("div",{className:"second-type",key:a._id+a.name,onClick:function(){return e.handleSecondPartClick(a,t.name)}},a.name)}))})),k.default.createElement(o.default,null,l.map(function(t){return k.default.createElement(s.default,{key:t._id+t.name,span:4},k.default.createElement("div",{className:"super-type"},t.name),t.sub_list.map(function(a){return k.default.createElement("div",{className:"second-type",key:a._id+a.name,onClick:function(){return e.handleSecondPartClick(a,t.name)}},a.name)}))}),k.default.createElement(s.default,{span:4},k.default.createElement("div",{className:"super-type"})))))}}]),Type}(g.default);a.default=_},o=function(e,t,a){t=e.exports=a(14)(),t.push([e.i,".super-type {\n  font-size: 14px;\n  background-color: #f1f1f1;\n  height: 34px;\n  line-height: 34px;\n  text-align: center;\n  margin: 5px -16px;\n}\n.second-type {\n  height: 26px;\n  line-height: 26px;\n  text-align: center;\n  font-size: 14px;\n}\n.second-type:hover {\n  color: #108ee9;\n  cursor: pointer;\n}\n",""])},u=function(e,t,a){var n=a(1756);"string"==typeof n&&(n=[[e.i,n,""]]);a(15)(n,{});n.locals&&(e.exports=n.locals)},s=function(e,a,n){"use strict";function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var r=function(){function defineProperties(e,a){for(var n=0;n<a.length;n++){var r=a[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),t.Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),i=n(0),l=function(e){return e&&e.__esModule?e:{default:e}}(i),o=function(e){function PrintThisComponent(e){_classCallCheck(this,PrintThisComponent);var a=_possibleConstructorReturn(this,(PrintThisComponent.__proto__||t.Object.getPrototypeOf(PrintThisComponent)).call(this,e));return a.printThis=a.printThis.bind(a),a}return _inherits(PrintThisComponent,e),r(PrintThisComponent,[{key:"setCanvasPrintImg",value:function(e,t){t.src=e.toDataURL("image/png")}},{key:"printThis",value:function(e){var a=t.$.extend({},{debug:!1,importCSS:!0,importStyle:!1,printContainer:!0,loadCSS:"",pageTitle:"",removeInline:!1,printDelay:333,header:null,footer:null,formValues:!0,doctypeString:"<!DOCTYPE html>"},e),n=e.element,r="printThis-"+(new t.Date).getTime();if(t.window.location.hostname!==t.document.domain&&t.navigator.userAgent.match(/msie/i)){var i='javascript:document.write("<head><script>document.domain=\\"'+t.document.domain+'\\";<\/script></head><body></body>")',l=t.document.createElement("iframe");l.name="printIframe",l.id=r,l.className="MSIE",t.document.body.appendChild(l),l.src=i}else{t.$("<iframe id='"+r+"' name='printIframe' />").appendTo("body")}var o=t.$("#"+r);o.portrait=!0,a.debug||o.css({position:"absolute",width:"0px",height:"0px",left:"-600px",top:"-600px"}),t.setTimeout(function(){a.doctypeString&&function(e,t){var a=e.get(0);a=a.contentWindow||a.contentDocument||a;var n=a.document||a.contentDocument||a;n.open(),n.write(t),n.close()}(o,a.doctypeString);var e=o.contents(),r=e.find("head"),i=e.find("body");if(r.append('<base href="'+t.document.location.protocol+"//"+t.document.location.host+'">'),a.importCSS&&t.$("link[rel=stylesheet]").each(function(){var e=t.$(this).attr("href");if(e){var a=t.$(this).attr("media")||"all";r.append("<link type='text/css' rel='stylesheet' href='"+e+"' media='"+a+"'>")}}),a.importStyle&&t.$("style").each(function(){t.$(this).clone().appendTo(r)}),a.pageTitle&&r.append("<title>"+a.pageTitle+"</title>"),a.loadCSS&&(t.$.isArray(a.loadCSS)?t.jQuery.each(a.loadCSS,function(){r.append("<link type='text/css' rel='stylesheet' href='"+this+"'>")}):r.append("<link type='text/css' rel='stylesheet' href='"+a.loadCSS+"'>")),a.header&&i.append(a.header),a.printContainer?i.append(this.outer(n)):n.each(function(){i.append(t.$(this).html())}),a.formValues){var l=n.find("input");l.length&&l.each(function(){var a=t.$(this),n=t.$(this).attr("name"),r=a.is(":checkbox")||a.is(":radio"),i=e.find('input[name="'+n+'"]'),l=a.val();r?a.is(":checked")&&(a.is(":checkbox")?i.attr("checked","checked"):a.is(":radio")&&e.find('input[name="'+n+'"][value='+l+"]").attr("checked","checked")):i.val(l)});var u=n.find("select");u.length&&u.each(function(){var a=t.$(this),n=t.$(this).attr("name"),r=a.val();e.find('select[name="'+n+'"]').val(r)});var s=n.find("textarea");s.length&&s.each(function(){var a=t.$(this),n=t.$(this).attr("name"),r=a.val();e.find('textarea[name="'+n+'"]').val(r)})}a.removeInline&&(t.$.isFunction(t.$.removeAttr)?e.find("body *").removeAttr("style"):e.find("body *").attr("style","")),a.footer&&i.append(a.footer),t.setTimeout(function(){o.hasClass("MSIE")?(t.window.frames.printIframe.focus(),r.append("<script>  window.print(); <\/script>")):t.document.queryCommandSupported("print")?o[0].contentWindow.document.execCommand("print",!1,null):(o[0].contentWindow.focus(),o[0].contentWindow.print()),a.debug||t.setTimeout(function(){o.remove()},1e3)},a.printDelay)},333)}},{key:"outer",value:function(){return t.$(t.$("<div></div>").html(this.clone())).html()}},{key:"render",value:function(){return l.default.createElement("div",null)}}]),PrintThisComponent}(l.default.Component);a.default=o},c=function(e,a,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var r=(n(312),n(311)),i=_interopRequireDefault(r),l=(n(49),n(48)),o=_interopRequireDefault(l),u=(n(51),n(50)),s=_interopRequireDefault(u),c=(n(157),n(35)),d=_interopRequireDefault(c),f=(n(47),n(41)),p=_interopRequireDefault(f),h=(n(66),n(65)),m=_interopRequireDefault(h),y=(n(37),n(59)),v=_interopRequireDefault(y),k=(n(158),n(131)),b=_interopRequireDefault(k),g=(n(68),n(67)),w=_interopRequireDefault(g),P=t.Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var r in n)t.Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_=function(){function defineProperties(e,a){for(var n=0;n<a.length;n++){var r=a[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),t.Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),E=n(0),S=_interopRequireDefault(E),C=n(22),R=_interopRequireDefault(C),D=n(114),x=_interopRequireDefault(D),I=n(116),N=_interopRequireDefault(I),j=n(313),A=_interopRequireDefault(j),M=n(1745),O=_interopRequireDefault(M),T=w.default.Item,q=b.default.Option,z=v.default.TextArea,G=function(e){function NewPart(e){_classCallCheck(this,NewPart);var a=_possibleConstructorReturn(this,(NewPart.__proto__||t.Object.getPrototypeOf(NewPart)).call(this,e));return a.state={visible:!1,types:[],partId:"",partCategories:[]},["handleNewPart","handleSearch","handleSearchSelect","handleSubmit","handleChoosePartType"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(NewPart,e),_(NewPart,[{key:"handleNewPart",value:function(){this.getMaintainItemTypes(),this.showModal()}},{key:"handleSearch",value:function(e,t,a){var n=this;e&&R.default.ajax({url:R.default.warehouse.category.search(e)},function(e){t(e.res.list),n.setState({partCategories:e.res.list})},function(e){a(e),n.setState({partCategories:[]})})}},{key:"handleSearchSelect",value:function(e){this.setState({part_type:e._id})}},{key:"handleChoosePartType",value:function(e){this.setState({partId:e})}},{key:"handleSubmit",value:function(){var e=this;this.props.form.validateFieldsAndScroll(function(a,n){if(a)return void m.default.warning("请完善表单信息");var r=e.state.partId;if(!r)return void m.default.warning("请选择配件分类");n.part_type=r,n.markup_rate=t.Number(n.markup_rate)/100,R.default.ajax({url:R.default.warehouse.part.add(),type:"POST",data:n},function(t){m.default.success("添加成功！"),e.props.onSuccess(t.res.auto_part),e.props.form.resetFields(),e.hideModal()})})}},{key:"hideModal",value:function(){this.setState({visible:!1}),this.props.form.resetFields()}},{key:"getMaintainItemTypes",value:function(){var e=this;R.default.ajax({url:R.default.aftersales.getMaintainItemTypes()},function(t){e.setState({types:t.res.type_list})})}},{key:"render",value:function(){var e=x.default.formItemLayout,t=x.default.formItemLayoutHalf,a=this.props.form.getFieldDecorator,n=this.state.visible;return S.default.createElement("span",null,S.default.createElement(p.default,{type:"primary",onClick:this.handleNewPart},"创建配件"),S.default.createElement(i.default,{title:S.default.createElement("span",null,S.default.createElement(d.default,{type:"plus"})," 创建配件"),visible:n,onCancel:this.hideModal,onOk:this.handleSubmit,width:720,style:{zIndex:"9999"}},S.default.createElement(w.default,null,S.default.createElement(o.default,null,S.default.createElement(s.default,{span:12},S.default.createElement(T,P({label:"配件名称"},e),a("name",{initialValue:this.props.inputValue,rules:N.default.getRulePartName(),validateTrigger:"onBlur"})(S.default.createElement(v.default,{placeholder:"请输入配件名称"})))),S.default.createElement(s.default,{span:12},S.default.createElement(T,P({label:"配件号"},e),a("part_no",{rules:N.default.getRulePartNo(),validateTrigger:"onBlur"})(S.default.createElement(v.default,{placeholder:"请输入配件号"}))))),S.default.createElement(o.default,null,S.default.createElement(s.default,{span:12},S.default.createElement(T,P({label:"规格"},e),a("spec",{initialValue:"1"})(S.default.createElement(v.default,{addonAfter:a("unit",{initialValue:"个"})(S.default.createElement(b.default,{style:{width:45}},S.default.createElement(q,{value:"个"},"个"),S.default.createElement(q,{value:"升"},"升"),S.default.createElement(q,{value:"瓶"},"瓶"),S.default.createElement(q,{value:"件"},"件"),S.default.createElement(q,{value:"副"},"副"),S.default.createElement(q,{value:"根"},"根"),S.default.createElement(q,{value:"条"},"条"))),placeholder:"请输入规格"})))),S.default.createElement(s.default,{span:12},S.default.createElement(T,P({label:"配件品牌"},e),a("brand")(S.default.createElement(v.default,{placeholder:"请输入配件品牌"}))))),S.default.createElement(o.default,null,S.default.createElement(s.default,{span:12},S.default.createElement(T,P({label:"适用车型"},e),a("scope")(S.default.createElement(v.default,{placeholder:"请输入适用车型"})))),S.default.createElement(s.default,{span:12},S.default.createElement(T,P({label:"配件分类"},e,{required:!0}),S.default.createElement(O.default,{onSuccess:this.handleChoosePartType})))),S.default.createElement(o.default,null,S.default.createElement(s.default,{span:12},S.default.createElement(T,P({label:"安全库存"},e),a("min_amount")(S.default.createElement(v.default,{placeholder:"请输入安全库存"})))),S.default.createElement(s.default,{span:12},S.default.createElement(T,P({label:"加价率"},e),a("markup_rate")(S.default.createElement(v.default,{placeholder:"请输入加价率",addonAfter:"%",style:{width:"200px"}}))))),S.default.createElement(o.default,null,S.default.createElement(s.default,{span:24},S.default.createElement(T,P({label:"备注"},t),a("remark",{initialValue:""})(S.default.createElement(z,{placeholder:"请输入备注"}))))))))}}]),NewPart}(A.default);G=w.default.create()(G),a.default=G},d=function(e,a,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var r=(n(628),n(627)),i=_interopRequireDefault(r),l=function(){function defineProperties(e,a){for(var n=0;n<a.length;n++){var r=a[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),t.Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),o=n(0),u=_interopRequireDefault(o),s=n(1763),c=_interopRequireDefault(s),d=n(1696),f=n(1673),p=function(e){function SearchDropDown(e){_classCallCheck(this,SearchDropDown);var a=_possibleConstructorReturn(this,(SearchDropDown.__proto__||t.Object.getPrototypeOf(SearchDropDown)).call(this,e));return a.state={partsInfo:""},["handleTableRow","handleCancel","handleSuccess","eventListenerFun"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(SearchDropDown,e),l(SearchDropDown,[{key:"componentDidMount",value:function(){t.document.addEventListener("click",this.eventListenerFun,!1)}},{key:"componentWillReceiveProps",value:function(e){var a=this;e.partsInfo&&(e.partsInfo.visible&&t.document.addEventListener("click",this.eventListenerFun,!1),this.setState({partsInfo:e.partsInfo},function(){e.partsInfo.keyword||a.handleCancel()}))}},{key:"componentWillUnmount",value:function(){t.document.removeEventListener("click",this.eventListenerFun,!1)}},{key:"handleTableRow",value:function(e){this.handleCancel(),this.props.onTableRowClick(e),this.props.onCancel&&this.props.onCancel()}},{key:"handleCancel",value:function(){var e=this.state.partsInfo;e.visible=!1,t.document.removeEventListener("click",this.eventListenerFun,!1),this.setState({partsInfo:e}),this.props.onCancel&&this.props.onCancel()}},{key:"handleSuccess",value:function(e){this.props.onTableRowClick(e)}},{key:"handleClick",value:function(e){e.nativeEvent.stopImmediatePropagation()}},{key:"eventListenerFun",value:function(){var e=this.state.partsInfo;e||(e={}),e.visible=!1,this.setState({partsInfo:e}),this.handleCancel()}},{key:"render",value:function(){var e=this.state.partsInfo,a=this.props.isInsertPart,n=e.info?e.info:[],r=n&&0===n.length?"210px":"800px";n&&0===n.length&&(r="false"===a?"800px":"210px");var l=[{title:"配件名",dataIndex:"name",key:"name",width:"20%"},{title:"配件号",dataIndex:"part_no",key:"part_no",width:"20%"},{title:"规格",dataIndex:"spec",key:"spec",width:"15%",render:function(e,t){return""+e+t.unit}},{title:"品牌",dataIndex:"brand",key:"brand",width:"10%"},{title:"适用车型",dataIndex:"scope",key:"scope",width:"20%"},{title:"剩余库存",dataIndex:"amount",key:"amount",width:"15%",render:function(e,a){return t.Number(e)-t.Number(a.freeze)}}],o={display:"none"};return e.coordinate&&(o={position:"absolute",width:r,left:e.coordinate.left+"px"||"",top:e.coordinate.top+10+"px"||"",display:e.visible?"":"none",zIndex:9998,backgroundColor:"white"}),u.default.createElement("div",{style:o,onClick:this.handleClick},u.default.createElement("img",{src:f,className:"close",onClick:this.handleCancel}),"false"!==a&&n&&0===n.length?u.default.createElement("div",{className:"padding-20 center",style:{boxShadow:"0 0 4px #cccccc"}},u.default.createElement("img",{src:d,style:{width:"40px",height:"40px"}}),u.default.createElement("p",null,"暂时没有找到该配件，请更换关键字查询或创建新配件"),u.default.createElement("div",{className:"mt10"},u.default.createElement(c.default,{onSuccess:this.handleSuccess,hideModal:this.handleCancel,inputValue:e.keyword}))):u.default.createElement(i.default,{dataSource:n,columns:l,size:"small",bordered:!1,pagination:!1,onRowClick:this.handleTableRow,rowKey:function(e){return e._id},scroll:{y:200}}))}}]),SearchDropDown}(o.Component);a.default=p},f=function(e,a,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var a=e.apply(this,arguments);return new t.Promise(function(e,n){function step(r,i){try{var l=a[r](i),o=l.value}catch(e){return void n(e)}if(!l.done)return t.Promise.resolve(o).then(function(e){step("next",e)},function(e){step("throw",e)});e(o)}return step("next")})}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var r=(n(317),n(324)),i=_interopRequireDefault(r),l=(n(47),n(41)),o=_interopRequireDefault(l),u=(n(157),n(35)),s=_interopRequireDefault(u),c=(n(66),n(65)),d=_interopRequireDefault(c),f=function(){function defineProperties(e,a){for(var n=0;n<a.length;n++){var r=a[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),t.Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),p=n(0),h=_interopRequireDefault(p),m=n(132),y=n(635),v=_interopRequireDefault(y),k=n(22),b=_interopRequireDefault(k),g=n(1615),w=_interopRequireDefault(g),P=function(e){function AuthPopover(e){_classCallCheck(this,AuthPopover);var a=_possibleConstructorReturn(this,(AuthPopover.__proto__||t.Object.getPrototypeOf(AuthPopover)).call(this,e));return a.state={visible:!1,hasPermission:!1,updatePermission:!1,detail:{}},a.handleAuthPrepare=a.handleAuthPrepare.bind(a),a.handleCheckUpdate=a.handleCheckUpdate.bind(a),a}return _inherits(AuthPopover,e),f(AuthPopover,[{key:"componentDidMount",value:function(){this.checkPermission(w.default.warehouse.stocktaking.auth),this.handleCheckUpdate()}},{key:"componentWillReceiveProps",value:function(e){e.updatePermission&&this.setState({updatePermission:e.updatePermission})}},{key:"componentWillUnmount",value:function(){t.clearInterval(this.interval)}},{key:"handleAuthPrepare",value:function(e){e?this.interval=t.setInterval(this.getStocktakingDetail.bind(this,this.props.id),2e3):t.clearInterval(this.interval),this.setState({visible:e})}},{key:"handleCheckUpdate",value:function(){var e=this,t=this.props.id;b.default.ajax({url:b.default.warehouse.stocktaking.checkUpdateAllStockaking(),type:"POST",data:{stocktaking_id:t}},function(){e.setState({updatePermission:!0})},function(){e.setState({updatePermission:!1})})}},{key:"getStocktakingDetail",value:function(e){var a=this;b.default.ajax({url:b.default.warehouse.stocktaking.detail(e)},function(n){var r=n.res.detail;a.setState({detail:r}),"0"!==r.authorize_user_id.toString()&&(t.clearInterval(a.interval),t.location.href="/warehouse/stocktaking/auth/"+e)},function(e){d.default.error("获取详情失败["+e+"]"),t.clearInterval(a.interval)})}},{key:"checkPermission",value:function(){function checkPermission(t){return e.apply(this,arguments)}var e=_asyncToGenerator(t.regeneratorRuntime.mark(function _callee(e){var a;return t.regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.default.checkPermission(e);case 2:a=t.sent,this.setState({hasPermission:a});case 4:case"end":return t.stop()}},_callee,this)}));return checkPermission}()},{key:"render",value:function(){var e=this.props,a=e.id,n=e.type,r=e.size,l=e.text,u=this.state,c=u.hasPermission,f=u.detail,p=u.updatePermission,y=f.authorize_user_id,k=h.default.createElement("div",{className:"center"},h.default.createElement(v.default,{value:t.JSON.stringify({authType:n,requestParams:{type:"post",url:b.default.warehouse.stocktaking.auth(),data:{stocktaking_id:a}}}),size:128,ref:"qrCode"}),h.default.createElement("p",null,"请扫码确认"),h.default.createElement("p",null,"查看完整盘点单"),h.default.createElement("p",null,h.default.createElement(s.default,{type:"check-circle",className:y&&"0"!==y?"confirm-check":"hide"})));return c?p?h.default.createElement("span",null,"default"===r?h.default.createElement(o.default,{type:"danger",size:r},h.default.createElement(m.Link,{to:{pathname:"/warehouse/stocktaking/auth/"+a}},l)):h.default.createElement(m.Link,{to:{pathname:"/warehouse/stocktaking/auth/"+a}},l)):h.default.createElement("span",null,"default"===r?h.default.createElement(o.default,{type:"danger",size:r,onClick:function(){return d.default.warn("盘点单信息填写不完整")}},l):h.default.createElement("a",{href:"javascript:;",onClick:function(){return d.default.warn("盘点单信息填写不完整")}},l)):h.default.createElement(i.default,{content:k,title:"",trigger:"click",visible:this.state.visible,onVisibleChange:this.handleAuthPrepare},"default"===r?h.default.createElement(o.default,{type:"danger",size:r},l):h.default.createElement("a",{href:"javascript:;"},l))}}]),AuthPopover}(h.default.Component);P.defaultProps={size:"small",text:"审核"},a.default=P},p=function(e,a,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var r=(n(312),n(311)),i=_interopRequireDefault(r),l=(n(49),n(48)),o=_interopRequireDefault(l),u=(n(51),n(50)),s=_interopRequireDefault(u),c=(n(157),n(35)),d=_interopRequireDefault(c),f=(n(47),n(41)),p=_interopRequireDefault(f),h=(n(66),n(65)),m=_interopRequireDefault(h),y=(n(37),n(59)),v=_interopRequireDefault(y),k=function(){function defineProperties(e,a){for(var n=0;n<a.length;n++){var r=a[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),t.Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),b=n(0),g=_interopRequireDefault(b),w=n(313),P=_interopRequireDefault(w),_=n(198),E=_interopRequireDefault(_),S=n(22),C=_interopRequireDefault(S),R=v.default.Search,D=function(e){function AddPart(e){_classCallCheck(this,AddPart);var a=_possibleConstructorReturn(this,(AddPart.__proto__||t.Object.getPrototypeOf(AddPart)).call(this,e));return a.state={visible:!1,page:1,parts:new t.Set,countPartsMap:new t.Map,selectPartsMap:new t.Map},["handleCancel","handleSearchSelect","handlePageChange","handleSubmit","handlePartsSearch"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(AddPart,e),k(AddPart,[{key:"componentWillReceiveProps",value:function(e){e.chooseParts&&this.handleSearchSelect(e.chooseParts),e.partsAll&&this.setState({partsAll:e.partsAll})}},{key:"handleCancel",value:function(){this.hideModal(),this.props.showPartsInfo({})}},{key:"handleSearchSelect",value:function(e){var a=this.state,n=a.parts,r=a.partsAll,i=!0,l=!1,o=void 0;try{for(var u,s=r[t.Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;if(t.String(c.part_id)===t.String(e._id))return m.default.error("这个配件已经在盘点中！"),!1}}catch(e){l=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(l)throw o}}e&&"-1"!==t.String(e._id)&&(n.add(e),this.setState({parts:n}))}},{key:"handlePageChange",value:function(e){this.setState({page:e})}},{key:"handleDelete",value:function(e){var t=this.state,a=t.parts,n=t.countPartsMap,r=t.selectPartsMap;a.forEach(function(t){t._id===e&&a.delete(t)}),n.delete(e),r.delete(e),this.setState({parts:a})}},{key:"handleInputBlur",value:function(e,t,a){var n=a.target.value,r=this.state,i=r.countPartsMap,l=r.selectPartsMap;if(i.has(e)){var o=i.get(e);o.real_amount=n,i.set(e,o),l.set(e,o)}else i.set(e,{_id:0,part_id:e,real_amount:n}),l.set(e,{_id:0,part_id:e,real_amount:n,auto_part:t});this.setState({countPartsMap:i,selectPartsMap:l})}},{key:"handlePartsSearch",value:function(e){var t=this,a=C.default.getPosition(e),n=e.target.value;n.length>=1&&C.default.ajax({url:C.default.warehouse.part.list({key:n})},function(e){var r=e.res.list,i={};i.info=r,i.coordinate=a,i.visible=!0,i.keyword=n,t.props.showPartsInfo(i)})}},{key:"handleSubmit",value:function(){var e=this,a=this.state,n=a.countPartsMap,r=a.selectPartsMap,i=[],l=[];if(n.forEach(function(e){i.push(e)}),r.forEach(function(e){l.push(e)}),0===l.length)return m.default.warn("请添加配件并检查配件实际数量"),!1;C.default.ajax({url:C.default.warehouse.stocktaking.updateParts(),type:"POST",data:{stocktaking_id:this.props.stocktakingId,items:t.JSON.stringify(i)}},function(){m.default.info("添加成功！"),e.props.onSave(l),e.hideModal()})}},{key:"render",value:function(){var e=this.state,a=e.page,n=e.visible,r=this.state.parts;r=t.Array.from(r);var l=this,u=[{title:"配件名",dataIndex:"name",key:"name",width:"15%"},{title:"配件号",dataIndex:"part_no",key:"part_no",width:"15%"},{title:"规格",className:"text-right",width:"10%",render:function(e,t){return""+(t.spec||"")+(t.unit||"")}},{title:"适用车型",dataIndex:"scope",key:"scope",width:"15%"},{title:"品牌",dataIndex:"brand",key:"brand",width:"15%"},{title:"实际数量",dataIndex:"_id",key:"real_amount",className:"center",width:"15%",render:function(e,t){return g.default.createElement(v.default,{style:{width:100},onBlur:l.handleInputBlur.bind(l,e,t)})}},{title:"操作",dataIndex:"_id",key:"action",className:"center",width:"15%",render:function(e){return g.default.createElement("a",{href:"javascript:",onClick:l.handleDelete.bind(l,e)},"删除")}}];return g.default.createElement("span",null,g.default.createElement(p.default,{type:"ghost",onClick:this.showModal},"添加配件"),g.default.createElement(i.default,{title:g.default.createElement("span",null,g.default.createElement(d.default,{type:"plus"})," 添加配件"),visible:n,maskClosable:!1,width:960,onCancel:this.handleCancel,onOk:this.handleSubmit,okText:"添加到盘点单"},g.default.createElement(o.default,{type:"flex",className:"mb10"},g.default.createElement(s.default,{span:12},g.default.createElement(R,{placeholder:"用关键字或编号搜索配件",style:{width:210},onChange:this.handlePartsSearch,size:"large"}))),g.default.createElement(E.default,{columns:u,dataSource:r,total:r.length,currentPage:a,onPageChange:this.handlePageChange,size:"small"})))}}]),AddPart}(P.default);a.default=D},h=function(e,a,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var r=(n(66),n(65)),i=_interopRequireDefault(r),l=function(){function defineProperties(e,a){for(var n=0;n<a.length;n++){var r=a[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),t.Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),o=n(0),u=_interopRequireDefault(o),s=n(22),c=_interopRequireDefault(s),d=function(e){function Base(){return _classCallCheck(this,Base),_possibleConstructorReturn(this,(Base.__proto__||t.Object.getPrototypeOf(Base)).apply(this,arguments))}return _inherits(Base,e),l(Base,[{key:"handlePageChange",value:function(e){this.setState({page:e}),this.getStockTakingParts(this.state.id,e)}},{key:"handleComplete",value:function(){t.location.href="/warehouse/stocktaking/index"}},{key:"handleInputBlur",value:function(e,a,n,r){var l=this,o=r.target.value;if(o){var u=[],s={_id:e,real_amount:o};e||(s.part_id=a),u.push(s),c.default.ajax({url:c.default.warehouse.stocktaking.updateParts(),type:"POST",data:{stocktaking_id:this.state.id,items:t.JSON.stringify(u)}},function(){i.default.info("保存成功！"),l.handleCheckUpdate(n)})}}},{key:"handleSaveNewParts",value:function(){var e=this.state,t=e.id,a=e.page;this.getStockTakingParts(t,a)}},{key:"handleCheckUpdate",value:function(e){var t=this;c.default.ajax({url:c.default.warehouse.stocktaking.checkUpdateAllStockaking(),type:"POST",data:{stocktaking_id:e}},function(){t.setState({updatePermission:!0})},function(){t.setState({updatePermission:!1})})}},{key:"getStocktakingDetail",value:function(e){var t=this;c.default.ajax({url:c.default.warehouse.stocktaking.detail(e)},function(e){t.setState({detail:e.res.detail}),t.getAllStockTakingParts(e.res.detail._id)})}},{key:"getStockTakingParts",value:function(e,a){var n=this;this.setState({isFetching:!0}),c.default.ajax({url:c.default.warehouse.stocktaking.parts(e,a)},function(e){n.setState({isFetching:!1,parts:e.res.list,total:t.parseInt(e.res.total,10)})})}},{key:"getAllStockTakingParts",value:function(e){var a=this;this.setState({isFetching:!0}),c.default.ajax({url:c.default.warehouse.stocktaking.parts(e)},function(e){a.setState({isFetching:!1,partsAll:e.res.list,total:t.parseInt(e.res.total,10)})})}}]),Base}(u.default.Component);a.default=d},m=function(e,a,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var r=(n(312),n(311)),i=_interopRequireDefault(r),l=(n(327),n(326)),o=_interopRequireDefault(l),u=(n(628),n(627)),s=_interopRequireDefault(u),c=(n(157),n(35)),d=_interopRequireDefault(c),f=(n(47),n(41)),p=_interopRequireDefault(f),h=function(){function defineProperties(e,a){for(var n=0;n<a.length;n++){var r=a[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),t.Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),m=n(0),y=_interopRequireDefault(m),v=n(18),k=_interopRequireDefault(v),b=n(1762),g=_interopRequireDefault(b),w=n(22),P=_interopRequireDefault(w),_=function(e){function Print(e){_classCallCheck(this,Print);var a=_possibleConstructorReturn(this,(Print.__proto__||t.Object.getPrototypeOf(Print)).call(this,e));return a.state={visible:!1,isFetching:!1,parts:[]},a.showPrintModal=a.showPrintModal.bind(a),a.hideModal=a.hideModal.bind(a),a.handlePrint=a.handlePrint.bind(a),a}return _inherits(Print,e),h(Print,[{key:"showPrintModal",value:function(){this.getStocktakingParts(this.props.id),this.setState({visible:!0,isFetching:!0})}},{key:"hideModal",value:function(){this.setState({visible:!1})}},{key:"handlePrint",value:function(){var e=k.default.findDOMNode(this.refs.print_container);this.printThis({element:t.$(e),debug:!1,importCSS:!0,importStyle:!0,printContainer:!1,loadCSS:"/dist/print.css",pageTitle:"仓库盘点单",removeInline:!1,printDelay:300,header:"",footer:null,formValues:!0})}},{key:"getStocktakingParts",value:function(e){var t=this;P.default.ajax({url:P.default.warehouse.stocktaking.getAllParts(e)},function(e){t.setState({isFetching:!1,parts:e.res.list})})}},{key:"render",value:function(){var e=this.state,t=e.visible,a=e.isFetching,n=e.parts,r=[{title:"序号",dataIndex:"_id",key:"index",className:"center",render:function(e,t,a){return a+1}},{title:"配件分类",dataIndex:"auto_part.part_type_name",key:"part_type_name"},{title:"配件名",dataIndex:"auto_part.name",key:"name"},{title:"配件号",dataIndex:"auto_part.part_no",key:"part_no"},{title:"适用车型",dataIndex:"auto_part.scope",key:"scope"},{title:"品牌",dataIndex:"auto_part.brand",key:"brand"},{title:"实际数量",dataIndex:"",key:"real_amount",className:"center"}];return y.default.createElement("span",null,y.default.createElement(p.default,{type:"ghost",onClick:this.showPrintModal},"打印盘点单"),y.default.createElement(i.default,{title:y.default.createElement("span",null,y.default.createElement(d.default,{type:"file-text"})," 打印盘点单"),visible:t,maskClosable:!1,width:960,onCancel:this.hideModal,onOk:this.handlePrint,okText:"确认打印"},y.default.createElement(o.default,{spinning:a},y.default.createElement("div",{ref:"print_container"},y.default.createElement(s.default,{dataSource:n,columns:r,pagination:!1,size:"small",bordered:!0})))))}}]),Print}(g.default);a.default=_},y=function(e,a,n){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new t.TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new t.ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new t.TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=t.Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(t.Object.setPrototypeOf?t.Object.setPrototypeOf(e,a):e.__proto__=a)}t.Object.defineProperty(a,"__esModule",{value:!0});var r=(n(49),n(48)),i=_interopRequireDefault(r),l=(n(51),n(50)),o=_interopRequireDefault(l),u=(n(47),n(41)),s=_interopRequireDefault(u),c=(n(37),n(59)),d=_interopRequireDefault(c),f=(n(629),n(314)),p=_interopRequireDefault(f),h=function(){function defineProperties(e,a){for(var n=0;n<a.length;n++){var r=a[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),t.Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&defineProperties(e.prototype,t),a&&defineProperties(e,a),e}}(),m=n(0),y=_interopRequireDefault(m),v=n(198),k=_interopRequireDefault(v),b=n(1786),g=_interopRequireDefault(b),w=n(1967),P=_interopRequireDefault(w),_=n(1966),E=_interopRequireDefault(_),S=n(1850),C=_interopRequireDefault(S),R=n(1968),D=_interopRequireDefault(R),x=n(22),I=_interopRequireDefault(x),N=function(e){function Edit(e){_classCallCheck(this,Edit);var a=_possibleConstructorReturn(this,(Edit.__proto__||t.Object.getPrototypeOf(Edit)).call(this,e));return a.state={isFetching:!1,page:1,id:e.match.params.id,detail:{},parts:[],updatePermission:!1,chooseParts:""},["handlePageChange","handleSaveNewParts","handleComplete","handTableRowClick","handleShowPartsInfo"].map(function(e){return a[e]=a[e].bind(a)}),a}return _inherits(Edit,e),h(Edit,[{key:"componentDidMount",value:function(){var e=this.state,t=e.id,a=e.page;this.getStocktakingDetail(t),this.getStockTakingParts(t,a),this.setInputContentPadding()}},{key:"componentDidUpdate",value:function(){this.setInputContentPadding()}},{key:"setInputContentPadding",value:function(){var e=t.document.getElementsByClassName("input-content");if(e=t.Array.from(e))for(var a in e)e.hasOwnProperty(a)&&(e[a].parentNode.parentNode.style.padding="2px 2px")}},{key:"handleShowPartsInfo",value:function(e){this.setState({partsInfo:e,chooseParts:""})}},{key:"handTableRowClick",value:function(e){this.setState({chooseParts:e})}},{key:"render",value:function(){var e=this.state,a=e.isFetching,n=e.parts,r=e.page,l=e.total,u=e.id,c=e.detail,f=e.updatePermission,h=e.chooseParts,m=e.partsAll,v=this,b=[{title:"序号",dataIndex:"_id",key:"index",className:"center",width:"48px",render:function(e,t,a){return(r-1)*I.default.config.limit+(a+1)}},{title:"配件分类",dataIndex:"auto_part.part_type_name",key:"part_type_name",width:"245px",render:function(e){return e?e.length<=12?y.default.createElement("span",null,e):y.default.createElement(p.default,{placement:"topLeft",title:e},e):""}},{title:"配件名称",dataIndex:"auto_part.name",key:"name"},{title:"配件号",dataIndex:"auto_part.part_no",key:"part_no",width:"120px"},{title:"规格",key:"spec",width:"75px",render:function(e,t){return""+t.auto_part.spec+t.auto_part.unit}},{title:"适用车型",dataIndex:"auto_part.scope",key:"scope",width:"135px",render:function(e){return e?e.length<=8?y.default.createElement("span",null,e):y.default.createElement(p.default,{placement:"topLeft",title:e},e):""}},{title:"品牌",dataIndex:"auto_part.brand",key:"brand",width:"75px",render:function(e){return e?e.length<=4?y.default.createElement("span",null,e):y.default.createElement(p.default,{placement:"topLeft",title:e},e):""}},{title:"实际数量",dataIndex:"real_amount",key:"real_amount",className:"center",width:"75px",render:function(e,t){return y.default.createElement("div",null,y.default.createElement("div",{className:"input-content"}),y.default.createElement(d.default,{defaultValue:e,style:{width:70},onBlur:v.handleInputBlur.bind(v,t._id,t.auto_part._id,u),size:"large"}))}}];return y.default.createElement("div",null,y.default.createElement(g.default,{partsInfo:this.state.partsInfo,onTableRowClick:this.handTableRowClick}),y.default.createElement(i.default,{className:"0"===t.String(c.status)?"mb15":"hide"},y.default.createElement(o.default,{span:24},y.default.createElement("div",{className:"pull-right"},y.default.createElement("span",{className:"mr10"},y.default.createElement(C.default,{size:"default",id:u,updatePermission:f})),y.default.createElement("span",{className:"mr10"},y.default.createElement(D.default,{id:u})),y.default.createElement(s.default,{type:"primary",onClick:this.handleComplete},"完成")))),y.default.createElement(i.default,{className:"0"===t.String(c.status)?"mb15":"hide"},y.default.createElement(o.default,{span:18},y.default.createElement("p",{className:"text-gray"},"提示：由于盘点数据过多，建议先打印盘点单，将盘点数据填写完整后,再进行系统录入，盘点单中缺失的配件，请点击“添加配件”手动录入")),y.default.createElement(o.default,{span:6},y.default.createElement("div",{className:"pull-right"},y.default.createElement(E.default,{stocktakingId:u,onSave:this.handleSaveNewParts,showPartsInfo:this.handleShowPartsInfo,chooseParts:h,partsAll:m})))),y.default.createElement(k.default,{isLoading:a,tip:"正在导入库存，请稍候...",columns:b,dataSource:n,total:l,currentPage:r,onPageChange:this.handlePageChange}))}}]),Edit}(P.default);a.default=N},v=e,k=v.webpackJsonp;if(v.webpackJsonp!==k)throw new Error("Prepack model invariant violation: "+v.webpackJsonp);var b=[17],g={1585:a,1615:n,1673:r,1696:i,1745:l,1756:o,1759:u,1762:s,1763:c,1786:d,1850:f,1966:p,1967:h,1968:m,671:y};k(b,g)}).call(this);